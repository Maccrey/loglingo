(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,76083,e=>{"use strict";let t=(0,e.i(86146).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],76083)},70337,e=>{"use strict";function t(e,t){let s="string"==typeof e?new Date(`${e}T00:00:00`):e;return new Intl.DateTimeFormat(t,{year:"numeric",month:"short",day:"numeric"}).format(s)}e.s(["formatDate",()=>t])},49667,e=>{"use strict";let t=(0,e.i(86146).default)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit3",()=>t],49667)},14623,e=>{"use strict";var t=e.i(82252),s=e.i(59372),a=e.i(59427),r=e.i(86823),l=e.i(86146);let i=(0,l.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),d=(0,l.default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);var n=e.i(49667),c=e.i(76083),o=e.i(78384),h=e.i(89877),m=e.i(45348),u=e.i(10551),x=e.i(47801),p=e.i(80798),y=e.i(31331),f=e.i(70337),j=e.i(67502);function g(){let e=(0,h.useTranslations)("diary"),l=(0,m.useLocale)(),g=(0,o.useRouter)(),{user:w,loading:N}=(0,x.useAuth)(),b=w?.uid??"",v=new Date().getFullYear(),[k,M]=(0,s.useState)(null),[C,D]=(0,s.useState)(null),T=!!b&&!N,{data:_=[],isLoading:A}=(0,u.useDiaryList)(b,void 0,{enabled:T});console.log("ðŸ“ Diary Page State:",{userId:b,loading:N,enabled:T,isLoading:A,diariesCount:_.length,diaries:_.slice(0,2)});let{remove:$}=(0,u.useDiaryMutations)(b),z=(0,s.useMemo)(()=>Array.from({length:12},(e,t)=>new Intl.DateTimeFormat(l,{month:"short"}).format(new Date(2020,t,1))),[l]),B=(0,s.useMemo)(()=>{let e=new Set;return _.forEach(t=>e.add(Number(t.date.split("-")[0]))),Array.from(e).sort((e,t)=>t-e)},[_,v]),P=(0,s.useMemo)(()=>null===k?_:_.filter(e=>Number(e.date.split("-")[0])===k),[_,k]),L=(0,s.useMemo)(()=>{let e={};return P.forEach(t=>{let s=new Date(`${t.date}T00:00:00`).getMonth();e[s]=(e[s]||0)+1}),e},[P]),S=(0,s.useMemo)(()=>null===C?P:P.filter(e=>new Date(`${e.date}T00:00:00`).getMonth()===C),[P,C]),E=async t=>{if(confirm(e("confirm_delete")))try{await $.mutateAsync(t.id),p.toast.success(e("delete_success"))}catch{p.toast.error(e("delete_error"))}},F=N||A||!T;return(0,t.jsx)(j.AuthGate,{children:(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:e("title")}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e("subtitle")})]}),(0,t.jsx)(o.Link,{href:"/diary/new",children:(0,t.jsxs)(a.Button,{children:[(0,t.jsx)(i,{className:"mr-2 h-4 w-4"}),e("new_entry")]})})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)(r.Card,{className:"md:col-span-1",children:[(0,t.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsx)(r.CardTitle,{className:"text-sm text-muted-foreground",children:e("filter_year")}),(0,t.jsx)(d,{className:"h-4 w-4 text-primary"})]}),(0,t.jsxs)(r.CardContent,{className:"space-y-2",children:[(0,t.jsxs)("select",{className:"w-full rounded-lg border border-white/10 bg-white/5 p-2 text-sm",value:null===k?"":k,onChange:e=>{M(""===e.target.value?null:Number(e.target.value))},children:[(0,t.jsx)("option",{value:"",children:e("all_years",{default:"All years"})}),B.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e("filter_month")}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,t.jsx)("button",{className:`rounded-md border border-white/10 px-3 py-2 text-left transition ${null===C?"bg-primary/20 text-primary-foreground":"hover:bg-white/5"}`,onClick:()=>D(null),children:e("all_months")}),z.map((e,s)=>(0,t.jsx)("button",{className:`rounded-md border border-white/10 px-3 py-2 text-left transition ${C===s?"bg-primary/20 text-primary-foreground":"hover:bg-white/5"}`,onClick:()=>D(s),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:e}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:L[s]||0})]})},e))]})]})]}),(0,t.jsx)("div",{className:"md:col-span-2 space-y-4",children:F?(0,t.jsx)(r.Card,{className:"border-dashed bg-transparent p-6 text-center",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:e("loading")})}):0===S.length?(0,t.jsxs)(r.Card,{className:"flex min-h-[200px] flex-col items-center justify-center border-dashed bg-transparent text-center",children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:e("empty")}),(0,t.jsx)(o.Link,{href:"/diary/new",className:"mt-3 inline-flex",children:(0,t.jsxs)(a.Button,{size:"sm",children:[(0,t.jsx)(i,{className:"mr-2 h-4 w-4"}),e("new_entry")]})})]}):(0,t.jsx)("div",{className:"grid gap-4",children:S.map(s=>(0,t.jsx)("div",{onClick:()=>g.push(`/diary/${s.id}`),className:"block",children:(0,t.jsxs)(r.Card,{className:"glass-card border-white/10 transition-all hover:shadow-lg hover:border-primary/40 cursor-pointer",children:[(0,t.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,f.formatDate)(s.date,l)}),(0,t.jsx)(r.CardTitle,{className:"line-clamp-1 text-xl",children:s.content.slice(0,40)||e("untitled")})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Button,{variant:"secondary",size:"sm",onClick:e=>{e.stopPropagation(),g.push(`/diary/${s.id}/edit`)},children:(0,t.jsx)(n.Edit3,{className:"h-4 w-4"})}),(0,t.jsxs)(a.Button,{variant:"ghost",size:"sm",onClick:e=>{e.preventDefault(),e.stopPropagation(),E(s)},disabled:$.isPending,children:[(0,t.jsx)(c.Trash2,{className:"mr-2 h-4 w-4"}),e("delete")]})]})]}),(0,t.jsxs)(r.CardContent,{className:"space-y-3",children:[s.imageUrl&&(0,t.jsx)(y.default,{src:s.imageUrl,alt:"Diary attachment",width:1200,height:800,className:"h-48 w-full rounded-lg object-cover",loading:"lazy",sizes:"(max-width: 768px) 100vw, 700px"}),(0,t.jsx)("p",{className:"line-clamp-3 text-sm leading-relaxed text-muted-foreground",children:s.content})]}),(0,t.jsxs)(r.CardFooter,{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,t.jsxs)("span",{children:[e("year_label"),": ",s.date.split("-")[0]]}),(0,t.jsxs)("span",{children:[e("month_label"),": ",z[new Date(`${s.date}T00:00:00`).getMonth()]]})]})]})},s.id))})})]})]})})}e.s(["default",()=>g],14623)}]);