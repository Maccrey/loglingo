module.exports=[43726,a=>{"use strict";let b=(0,a.i(16195).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["Trash2",()=>b],43726)},80025,32564,a=>{"use strict";var b=a.i(71544),c=a.i(62444),d=a.i(83744);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-10 w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-foreground placeholder:text-white/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary disabled:cursor-not-allowed disabled:opacity-50 backdrop-blur-sm transition-all hover:bg-white/10",a),ref:f,...e}));function f(a,b){}e.displayName="Input",a.s(["Input",()=>e],80025),a.s(["trackEvent",()=>f],32564)},12834,a=>{"use strict";var b=a.i(903);a.i(91105);var c=a.i(93019);let d=(0,c.collection)(b.db,"learning_archive");function e(a){let b=a.data(),d=b.createdAt instanceof c.Timestamp?b.createdAt.toDate():new Date(b.createdAt??Date.now());return{id:a.id,userId:b.userId,type:b.type,title:b.title,examples:b.examples||[],rootMeaning:b.rootMeaning||"",sourceId:b.sourceId,createdAt:d}}async function f(a,b,f){if(console.log("ðŸ” Archive Repository: listArchive called",{userId:a,type:b,sourceId:f}),!a)return console.log("âš ï¸ Archive Repository: No userId, returning empty array"),[];try{let g=[(0,c.where)("userId","==",a)];b&&g.push((0,c.where)("type","==",b)),f&&g.push((0,c.where)("sourceId","==",f));let h=(0,c.query)(d,...g);console.log("ðŸ” Archive Repository: Executing query...");let i=(await (0,c.getDocs)(h)).docs.map(e);return i.sort((a,b)=>b.createdAt.getTime()-a.createdAt.getTime()),console.log("âœ… Archive Repository: Query complete",{count:i.length,results:i.slice(0,2)}),i}catch(a){throw console.error("âŒ Archive Repository: Query failed",a),a}}async function g(a,b){if(console.log("ðŸ” Archive Repository: checkDuplicate",{userId:a,title:b}),!a||!b)return!1;try{let e=(0,c.query)(d,(0,c.where)("userId","==",a),(0,c.where)("title","==",b)),f=!(await (0,c.getDocs)(e)).empty;return console.log(f?"âš ï¸ Archive Repository: Duplicate found":"âœ… Archive Repository: No duplicate"),f}catch(a){return console.error("âŒ Archive Repository: Check duplicate failed",a),!1}}async function h(a){let b={...a,createdAt:(0,c.serverTimestamp)()},f=await (0,c.addDoc)(d,b);return(await (0,c.getDocs)((0,c.query)(d,(0,c.where)("__name__","==",f.id)))).docs.map(e)[0]}a.s(["checkDuplicate",()=>g,"createArchive",()=>h,"listArchive",()=>f])},16002,a=>{"use strict";var b=a.i(93051),c=a.i(61738),d=a.i(81473),e=a.i(12834);async function f(a){if(!a.title.trim())throw Error("title-required");return(0,e.createArchive)({...a,examples:a.examples?.filter(Boolean)??[],rootMeaning:a.rootMeaning??""})}async function g(a,b,c){return(0,e.listArchive)(a,b,c)}function h(a){let b=a.options.map((a,b)=>({option:a,index:b})).sort(()=>Math.random()-.5),c=b.findIndex(b=>b.index===a.correctIndex);return{...a,options:b.map(a=>a.option),correctIndex:c}}var i=a.i(903);a.i(91105);var j=a.i(93019);let k=(0,j.collection)(i.db,"quizzes");function l(a){let b=a.data(),c=b.createdAt instanceof j.Timestamp?b.createdAt.toDate():new Date(b.createdAt??Date.now());return{id:a.id,archiveId:b.archiveId,question:b.question,options:b.options||[],correctIndex:b.correctIndex??0,explanation:b.explanation||"",createdAt:c}}async function m(a){if(console.log("ðŸ” Quiz Repository: getQuizByArchiveId called",{archiveId:a}),!a)return console.log("âš ï¸ Quiz Repository: No archiveId provided"),null;try{let b=(0,j.query)(k,(0,j.where)("archiveId","==",a)),c=await (0,j.getDocs)(b);if(c.empty)return console.log("ðŸ“­ Quiz Repository: No quiz found for archiveId",a),null;let d=l(c.docs[0]);return console.log("âœ… Quiz Repository: Quiz found",{quizId:d.id}),d}catch(a){return console.error("âŒ Quiz Repository: Query failed",a),null}}async function n(a){console.log("ðŸ’¾ Quiz Repository: Creating quiz",{archiveId:a.archiveId});let b={...a,createdAt:(0,j.serverTimestamp)()},c=await (0,j.addDoc)(k,b),d=l((await (0,j.getDocs)((0,j.query)(k,(0,j.where)("__name__","==",c.id)))).docs[0]);return console.log("âœ… Quiz Repository: Quiz created",{quizId:d.id}),d}async function o(a){try{let b=await fetch("/api/quiz/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok)return console.error("Quiz generation API failed:",b.status),null;return await b.json()}catch(a){return console.error("Quiz generation request failed:",a),null}}async function p(a,b,c,d,e,f,g){console.log("ðŸŽ¯ Quiz Service: getOrGenerateQuiz",{archiveId:a,title:b});let i=await m(a);if(i)return console.log("âœ… Quiz Service: Found existing quiz",{quizId:i.id}),h(i);console.log("ðŸ¤– Quiz Service: No quiz found, generating with Grok AI...");let j=await o({title:b,rootMeaning:c,examples:d,uiLocale:f,learningLanguage:g});if(!j)return console.error("âŒ Quiz Service: Quiz generation failed"),null;let k={archiveId:a,question:e,options:j.options,correctIndex:j.correctIndex,explanation:j.explanation},l=await n(k);return console.log("ðŸ’¾ Quiz Service: Quiz saved to Firebase",{quizId:l.id}),h(l)}var q=a.i(62444);function r(a,b,d){return(0,c.useQuery)({queryKey:["archives",a,b??"all",d?.sourceId??"all"],queryFn:()=>g(a,b,d?.sourceId),enabled:(d?.enabled??!0)&&!!a,staleTime:6e4,refetchOnMount:!0})}function s(a){let c=(0,d.useQueryClient)();return{create:(0,b.useMutation)({mutationFn:f,onSuccess:()=>c.invalidateQueries({queryKey:["archives",a]})})}}function t(a,b,c,d){let[e,f]=(0,q.useState)(null),[g,h]=(0,q.useState)(!1),[i,j]=(0,q.useState)(null);return(0,q.useEffect)(()=>{if(!a||!b){f(null),h(!1);return}let e=!1;return async function(){if(a&&b){h(!0),j(null);try{let g=await p(a.id,a.title,a.rootMeaning||a.title,a.examples||[],b,c||"en",d||"en");!e&&(f(g),g||j("Quiz generation failed"))}catch(a){e||(console.error("Quiz loading error:",a),j("Failed to load quiz"),f(null))}finally{e||h(!1)}}}(),()=>{e=!0}},[a?.id,b,c,d]),{quiz:e,isLoading:g,error:i}}a.s(["useArchiveList",()=>r,"useArchiveMutations",()=>s,"useQuiz",()=>t],16002)},38790,a=>{"use strict";let b=(0,a.i(16195).default)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);a.s(["Archive",()=>b],38790)},14476,a=>{"use strict";function b(){return"demo-user"}a.i(903),a.s(["getCurrentUserId",()=>b])},36220,a=>{"use strict";var b=a.i(71544),c=a.i(62444),d=a.i(56887),e=a.i(80657),f=a.i(16002),g=a.i(14476),h=a.i(58081),i=a.i(82969),j=a.i(22172),k=a.i(82734),l=a.i(38790),m=a.i(28163);function n({params:a}){let{id:n}=(0,c.use)(a),o=(0,g.getCurrentUserId)(),p=(0,i.useTranslations)("diary"),q=(0,i.useTranslations)("archive"),r=(0,k.useRouter)(),{data:s,isLoading:t}=(0,e.useDiaryDetail)(o,n),{update:u,remove:v}=(0,e.useDiaryMutations)(o),{data:w=[],isLoading:x}=(0,f.useArchiveList)(o);return t?(0,b.jsx)(j.AuthGate,{children:(0,b.jsxs)(h.Card,{className:"max-w-3xl",children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsx)(h.CardTitle,{children:p("loading")})}),(0,b.jsx)(h.CardContent,{children:(0,b.jsx)("div",{className:"h-32 animate-pulse rounded-lg bg-white/5"})})]})}):s?(0,b.jsx)(j.AuthGate,{children:(0,b.jsxs)("div",{className:"mx-auto max-w-3xl space-y-6",children:[(0,b.jsx)(d.DiaryForm,{initial:s,onSubmit:async a=>{await u.mutateAsync({id:n,payload:a}),r.push("/diary")},onDelete:async()=>{await v.mutateAsync(n),r.push("/diary")},isSubmitting:u.isPending||v.isPending}),(0,b.jsxs)(h.Card,{children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Archive,{className:"h-5 w-5 text-primary"}),(0,b.jsx)(h.CardTitle,{children:q("title")})]})}),(0,b.jsx)(h.CardContent,{children:x?(0,b.jsx)("div",{className:"h-20 animate-pulse rounded-lg bg-white/5"}):w.length>0?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:"ì´ ì¼ê¸°ì—ì„œ ì €ìž¥ëœ í•™ìŠµ í•­ëª©ë“¤"}),w.slice(0,5).map(a=>(0,b.jsx)("div",{className:"rounded-lg border border-white/10 bg-white/5 p-3 hover:bg-white/10 transition-colors cursor-pointer",onClick:()=>r.push("/archive"),children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-foreground",children:a.title}),a.rootMeaning&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:a.rootMeaning})]}),(0,b.jsx)("span",{className:"text-xs px-2 py-1 rounded-full bg-primary/10 text-primary",children:"grammar"===a.type?"ë¬¸ë²•":"ë‹¨ì–´"})]})},a.id)),w.length>5&&(0,b.jsxs)("button",{onClick:()=>r.push("/archive"),className:"w-full text-sm text-primary hover:underline mt-2",children:["ì „ì²´ ë³´ê¸° (",w.length,"ê°œ)"]})]}):(0,b.jsxs)("div",{className:"text-center py-6",children:[(0,b.jsx)(m.Sparkles,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"ì•„ì§ ì €ìž¥ëœ í•™ìŠµ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"AI êµì •ì„ ì‚¬ìš©í•˜ë©´ ìžë™ìœ¼ë¡œ ì €ìž¥ë©ë‹ˆë‹¤"})]})})]})]})}):(0,b.jsx)(j.AuthGate,{children:(0,b.jsxs)(h.Card,{className:"max-w-3xl",children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsx)(h.CardTitle,{children:p("not_found")})}),(0,b.jsx)(h.CardContent,{children:(0,b.jsx)("p",{className:"text-muted-foreground",children:p("not_found_desc")})})]})})}a.s(["default",()=>n])},28920,a=>{a.v(a=>Promise.resolve().then(()=>a(12834)))}];

//# sourceMappingURL=Development_Loglingo_3fdb0961._.js.map