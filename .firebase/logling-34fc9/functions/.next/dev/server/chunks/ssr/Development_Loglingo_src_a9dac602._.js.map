{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/components/ui/Button.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { Loader2 } from \"lucide-react\";\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: \"primary\" | \"secondary\" | \"ghost\" | \"glass\" | \"destructive\";\n  size?: \"sm\" | \"md\" | \"lg\" | \"icon\";\n  isLoading?: boolean;\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant = \"primary\", size = \"md\", isLoading, children, ...props }, ref) => {\n    const variants = {\n      primary: \"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md\",\n      secondary: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n      ghost: \"hover:bg-white/10 text-foreground\",\n      glass: \"glass hover:bg-white/10 text-foreground active:scale-95 transition-transform\",\n      destructive: \"bg-red-500 text-white hover:bg-red-600\",\n    };\n\n    const sizes = {\n      sm: \"h-8 px-3 text-xs\",\n      md: \"h-10 px-4 py-2\",\n      lg: \"h-12 px-8 text-lg\",\n      icon: \"h-10 w-10 p-2 flex items-center justify-center\",\n    };\n\n    return (\n      <button\n        className={cn(\n          \"inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary disabled:pointer-events-none disabled:opacity-50\",\n          variants[variant],\n          sizes[size],\n          className\n        )}\n        ref={ref}\n        disabled={isLoading || props.disabled}\n        {...props}\n      >\n        {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n        {children}\n      </button>\n    );\n  }\n);\nButton.displayName = \"Button\";\n\nexport { Button };\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AASA,MAAM,uBAAS,8OAAgB,CAC7B,CAAC,EAAE,SAAS,EAAE,UAAU,SAAS,EAAE,OAAO,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IAC/E,MAAM,WAAW;QACf,SAAS;QACT,WAAW;QACX,OAAO;QACP,OAAO;QACP,aAAa;IACf;IAEA,MAAM,QAAQ;QACZ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,MAAM;IACR;IAEA,qBACE,yQAAC;QACC,WAAW,IAAA,oJAAE,EACX,gNACA,QAAQ,CAAC,QAAQ,EACjB,KAAK,CAAC,KAAK,EACX;QAEF,KAAK;QACL,UAAU,aAAa,MAAM,QAAQ;QACpC,GAAG,KAAK;;YAER,2BAAa,yQAAC,uPAAO;gBAAC,WAAU;;;;;;YAChC;;;;;;;AAGP;AAEF,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/components/ui/Card.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"glass-card bg-white/5 text-card-foreground p-6\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\";\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 pb-4\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\";\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight text-lg\", className)}\n    {...props}\n  />\n));\nCardTitle.displayName = \"CardTitle\";\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"pt-0\", className)} {...props} />\n));\nCardContent.displayName = \"CardContent\";\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center pt-4\", className)}\n    {...props}\n  />\n));\nCardFooter.displayName = \"CardFooter\";\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardContent };\n"],"names":[],"mappings":";;;;;;;;;;;;;AAAA;AACA;;;;AAEA,MAAM,qBAAO,8OAAgB,CAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yQAAC;QACC,KAAK;QACL,WAAW,IAAA,oJAAE,EACX,kDACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,8OAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yQAAC;QACC,KAAK;QACL,WAAW,IAAA,oJAAE,EAAC,kCAAkC;QAC/C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,8OAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yQAAC;QACC,KAAK;QACL,WAAW,IAAA,oJAAE,EAAC,qDAAqD;QAClE,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,8OAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yQAAC;QAAI,KAAK;QAAK,WAAW,IAAA,oJAAE,EAAC,QAAQ;QAAa,GAAG,KAAK;;;;;;AAE5D,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,8OAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yQAAC;QACC,KAAK;QACL,WAAW,IAAA,oJAAE,EAAC,0BAA0B;QACvC,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/domain/diary.ts"],"sourcesContent":["export interface Diary {\n  id: string;\n  userId: string;\n  date: string; // yyyy-mm-dd\n  content: string;\n  imageUrl?: string;\n  aiReviewed: boolean;\n  createdAt: Date;\n  updatedAt?: Date;\n}\n\nexport interface DiaryDraft {\n  userId: string;\n  date: string;\n  content: string;\n  imageUrl?: string;\n  aiReviewed?: boolean;\n}\n\nexport interface DiaryImageUploadResult {\n  url: string;\n  path: string;\n}\n\nexport interface DiaryRepository {\n  listByUser(userId: string, year?: number): Promise<Diary[]>;\n  getById(userId: string, id: string): Promise<Diary | null>;\n  create(input: DiaryDraft): Promise<Diary>;\n  update(id: string, input: Partial<DiaryDraft>): Promise<Diary>;\n  delete(id: string): Promise<void>;\n}\n\nexport function validateDiaryInput(input: Pick<DiaryDraft, \"date\" | \"content\">) {\n  const errors: string[] = [];\n\n  if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(input.date)) {\n    errors.push(\"invalid-date\");\n  }\n\n  const trimmed = input.content.trim();\n  if (!trimmed) {\n    errors.push(\"empty-content\");\n  }\n\n  if (trimmed.length > 5000) {\n    errors.push(\"too-long\");\n  }\n\n  return { valid: errors.length === 0, errors };\n}\n"],"names":[],"mappings":";;;;AAgCO,SAAS,mBAAmB,KAA2C;IAC5E,MAAM,SAAmB,EAAE;IAE3B,IAAI,CAAC,sBAAsB,IAAI,CAAC,MAAM,IAAI,GAAG;QAC3C,OAAO,IAAI,CAAC;IACd;IAEA,MAAM,UAAU,MAAM,OAAO,CAAC,IAAI;IAClC,IAAI,CAAC,SAAS;QACZ,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,QAAQ,MAAM,GAAG,MAAM;QACzB,OAAO,IAAI,CAAC;IACd;IAEA,OAAO;QAAE,OAAO,OAAO,MAAM,KAAK;QAAG;IAAO;AAC9C"}},
    {"offset": {"line": 155, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/lib/image.ts"],"sourcesContent":["\"use client\";\n\nconst MAX_DIMENSION = 1600;\nconst MAX_SIZE_BYTES = 300 * 1024;\n\nexport interface ImageConversionResult {\n  file: File;\n  previewUrl: string;\n}\n\nexport async function convertImageToWebP(file: File): Promise<ImageConversionResult> {\n  if (typeof window === \"undefined\") {\n    throw new Error(\"Image conversion is only available in the browser.\");\n  }\n\n  const image = await loadImage(file);\n  const canvas = document.createElement(\"canvas\");\n  const context = canvas.getContext(\"2d\");\n\n  if (!context) {\n    throw new Error(\"Failed to acquire 2D context for image conversion.\");\n  }\n\n  const scale = Math.min(1, MAX_DIMENSION / Math.max(image.width, image.height));\n  canvas.width = Math.max(1, Math.round(image.width * scale));\n  canvas.height = Math.max(1, Math.round(image.height * scale));\n\n  context.drawImage(image, 0, 0, canvas.width, canvas.height);\n\n  let quality = 0.9;\n  let blob = await toWebPBlob(canvas, quality);\n\n  while (blob && blob.size > MAX_SIZE_BYTES && quality > 0.4) {\n    quality -= 0.1;\n    blob = await toWebPBlob(canvas, quality);\n  }\n\n  if (blob && blob.size > MAX_SIZE_BYTES) {\n    blob = await toWebPBlob(canvas, 0.3);\n  }\n\n  if (!blob) {\n    throw new Error(\"Failed to generate image blob.\");\n  }\n\n  const optimizedFile = new File([blob], replaceExtension(file.name, \"webp\"), {\n    type: \"image/webp\",\n  });\n\n  return {\n    file: optimizedFile,\n    previewUrl: canvas.toDataURL(\"image/webp\", 0.8),\n  };\n}\n\nexport function getImagePreview(file: File): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => resolve(reader.result as string);\n    reader.onerror = () => reject(new Error(\"Failed to read image preview\"));\n    reader.readAsDataURL(file);\n  });\n}\n\nasync function loadImage(file: File): Promise<HTMLImageElement> {\n  const src = await getImagePreview(file);\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => resolve(img);\n    img.onerror = () => reject(new Error(\"Failed to load image\"));\n    img.src = src;\n  });\n}\n\nfunction replaceExtension(name: string, ext: string) {\n  const base = name.includes(\".\") ? name.substring(0, name.lastIndexOf(\".\")) : name;\n  return `${base}.${ext}`;\n}\n\nfunction toWebPBlob(canvas: HTMLCanvasElement, quality: number): Promise<Blob | null> {\n  return new Promise((resolve) => {\n    canvas.toBlob(\n      (blob) => resolve(blob),\n      \"image/webp\",\n      Math.max(0.2, Math.min(1, quality))\n    );\n  });\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAEA,MAAM,gBAAgB;AACtB,MAAM,iBAAiB,MAAM;AAOtB,eAAe,mBAAmB,IAAU;IACjD,wCAAmC;QACjC,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,QAAQ,MAAM,UAAU;IAC9B,MAAM,SAAS,SAAS,aAAa,CAAC;IACtC,MAAM,UAAU,OAAO,UAAU,CAAC;IAElC,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,QAAQ,KAAK,GAAG,CAAC,GAAG,gBAAgB,KAAK,GAAG,CAAC,MAAM,KAAK,EAAE,MAAM,MAAM;IAC5E,OAAO,KAAK,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,MAAM,KAAK,GAAG;IACpD,OAAO,MAAM,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,MAAM,MAAM,GAAG;IAEtD,QAAQ,SAAS,CAAC,OAAO,GAAG,GAAG,OAAO,KAAK,EAAE,OAAO,MAAM;IAE1D,IAAI,UAAU;IACd,IAAI,OAAO,MAAM,WAAW,QAAQ;IAEpC,MAAO,QAAQ,KAAK,IAAI,GAAG,kBAAkB,UAAU,IAAK;QAC1D,WAAW;QACX,OAAO,MAAM,WAAW,QAAQ;IAClC;IAEA,IAAI,QAAQ,KAAK,IAAI,GAAG,gBAAgB;QACtC,OAAO,MAAM,WAAW,QAAQ;IAClC;IAEA,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,gBAAgB,IAAI,KAAK;QAAC;KAAK,EAAE,iBAAiB,KAAK,IAAI,EAAE,SAAS;QAC1E,MAAM;IACR;IAEA,OAAO;QACL,MAAM;QACN,YAAY,OAAO,SAAS,CAAC,cAAc;IAC7C;AACF;AAEO,SAAS,gBAAgB,IAAU;IACxC,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,SAAS,IAAI;QACnB,OAAO,MAAM,GAAG,IAAM,QAAQ,OAAO,MAAM;QAC3C,OAAO,OAAO,GAAG,IAAM,OAAO,IAAI,MAAM;QACxC,OAAO,aAAa,CAAC;IACvB;AACF;AAEA,eAAe,UAAU,IAAU;IACjC,MAAM,MAAM,MAAM,gBAAgB;IAClC,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,MAAM,IAAI;QAChB,IAAI,MAAM,GAAG,IAAM,QAAQ;QAC3B,IAAI,OAAO,GAAG,IAAM,OAAO,IAAI,MAAM;QACrC,IAAI,GAAG,GAAG;IACZ;AACF;AAEA,SAAS,iBAAiB,IAAY,EAAE,GAAW;IACjD,MAAM,OAAO,KAAK,QAAQ,CAAC,OAAO,KAAK,SAAS,CAAC,GAAG,KAAK,WAAW,CAAC,QAAQ;IAC7E,OAAO,GAAG,KAAK,CAAC,EAAE,KAAK;AACzB;AAEA,SAAS,WAAW,MAAyB,EAAE,OAAe;IAC5D,OAAO,IAAI,QAAQ,CAAC;QAClB,OAAO,MAAM,CACX,CAAC,OAAS,QAAQ,OAClB,cACA,KAAK,GAAG,CAAC,KAAK,KAAK,GAAG,CAAC,GAAG;IAE9B;AACF"}},
    {"offset": {"line": 230, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/infrastructure/firebase/diary-repository.ts"],"sourcesContent":["import {\n  Diary,\n  DiaryDraft,\n  DiaryImageUploadResult,\n  DiaryRepository,\n} from \"@/domain/diary\";\nimport { db, storage } from \"@/lib/firebase\";\nimport {\n  addDoc,\n  collection,\n  DocumentData,\n  deleteDoc,\n  doc,\n  getDoc,\n  getDocs,\n  orderBy,\n  query,\n  type DocumentSnapshot,\n  type QueryDocumentSnapshot,\n  serverTimestamp,\n  Timestamp,\n  updateDoc,\n  where,\n} from \"firebase/firestore\";\nimport {\n  getDownloadURL,\n  ref,\n  uploadBytesResumable,\n  UploadTask,\n} from \"firebase/storage\";\n\nconst diariesCollection = collection(db, \"diaries\");\n\nfunction mapDiary(\n  snapshot: DocumentSnapshot<DocumentData> | QueryDocumentSnapshot<DocumentData>\n): Diary {\n  const data = snapshot.data();\n  if (!data) {\n    throw new Error(\"Diary snapshot is missing data\");\n  }\n  const createdAt =\n    data.createdAt instanceof Timestamp\n      ? data.createdAt.toDate()\n      : new Date(data.createdAt ?? Date.now());\n\n  const updatedAt =\n    data.updatedAt instanceof Timestamp\n      ? data.updatedAt.toDate()\n      : data.updatedAt\n      ? new Date(data.updatedAt)\n      : undefined;\n\n  return {\n    id: snapshot.id,\n    userId: data.userId,\n    date: data.date,\n    content: data.content,\n    imageUrl: data.imageUrl,\n    aiReviewed: Boolean(data.aiReviewed),\n    createdAt,\n    updatedAt,\n  };\n}\n\nasync function listByUser(userId: string, year?: number): Promise<Diary[]> {\n  const constraints = [where(\"userId\", \"==\", userId)];\n  if (year) {\n    constraints.push(where(\"date\", \">=\", `${year}-01-01`));\n    constraints.push(where(\"date\", \"<=\", `${year}-12-31`));\n  }\n\n  const q = query(\n    diariesCollection,\n    ...constraints,\n    orderBy(\"date\", \"desc\")\n  );\n\n  const snapshot = await getDocs(q);\n  return snapshot.docs.map(mapDiary);\n}\n\nasync function getById(userId: string, id: string): Promise<Diary | null> {\n  const refDoc = doc(diariesCollection, id);\n  const snapshot = await getDoc(refDoc);\n  if (!snapshot.exists()) return null;\n  const data = mapDiary(snapshot);\n  if (data.userId !== userId) return null;\n  return data;\n}\n\nasync function create(input: DiaryDraft): Promise<Diary> {\n  const payload = {\n    ...input,\n    aiReviewed: Boolean(input.aiReviewed),\n    createdAt: serverTimestamp(),\n    updatedAt: serverTimestamp(),\n  };\n\n  const refDoc = await addDoc(diariesCollection, payload);\n  const created = await getDoc(refDoc);\n  return mapDiary(created);\n}\n\nasync function update(id: string, input: Partial<DiaryDraft>): Promise<Diary> {\n  const refDoc = doc(diariesCollection, id);\n  await updateDoc(refDoc, { ...input, updatedAt: serverTimestamp() });\n  const updated = await getDoc(refDoc);\n  return mapDiary(updated);\n}\n\nasync function remove(id: string): Promise<void> {\n  const refDoc = doc(diariesCollection, id);\n  await deleteDoc(refDoc);\n}\n\nasync function uploadDiaryImage(\n  file: File,\n  userId: string,\n  onProgress?: (progress: number) => void\n): Promise<DiaryImageUploadResult> {\n  const safeName = file.name.replace(/\\s+/g, \"-\").toLowerCase();\n  const storageRef = ref(\n    storage,\n    `diaryImages/${userId}/${Date.now()}-${safeName}`\n  );\n  const uploadTask: UploadTask = uploadBytesResumable(storageRef, file, {\n    contentType: file.type,\n    cacheControl: \"public,max-age=31536000\",\n  });\n\n  return new Promise((resolve, reject) => {\n    uploadTask.on(\n      \"state_changed\",\n      (snapshot) => {\n        const progress = Math.round(\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n        );\n        onProgress?.(progress);\n      },\n      (error) => reject(error),\n      async () => {\n        const url = await getDownloadURL(uploadTask.snapshot.ref);\n        resolve({ url, path: uploadTask.snapshot.ref.fullPath });\n      }\n    );\n  });\n}\n\nexport const firebaseDiaryRepository: DiaryRepository & {\n  uploadDiaryImage: typeof uploadDiaryImage;\n} = {\n  listByUser,\n  getById,\n  create,\n  update,\n  delete: remove,\n  uploadDiaryImage,\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 337, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/application/diary/diary-service.ts"],"sourcesContent":["\"use client\";\n\nimport {\n  Diary,\n  DiaryDraft,\n  DiaryRepository,\n  validateDiaryInput,\n} from \"@/domain/diary\";\nimport { convertImageToWebP } from \"@/lib/image\";\nimport { firebaseDiaryRepository } from \"@/infrastructure/firebase/diary-repository\";\n\nexport interface DiaryPayload {\n  date: string;\n  content: string;\n  imageFile?: File | null;\n  removeImage?: boolean;\n}\n\nexport class DiaryValidationError extends Error {\n  reasons: string[];\n  constructor(reasons: string[]) {\n    super(\"Invalid diary input\");\n    this.reasons = reasons;\n  }\n}\n\nconst repository: DiaryRepository & {\n  uploadDiaryImage: typeof firebaseDiaryRepository.uploadDiaryImage;\n} = firebaseDiaryRepository;\n\nexport async function listDiaries(userId: string, year?: number) {\n  return repository.listByUser(userId, year);\n}\n\nexport async function getDiary(userId: string, id: string) {\n  return repository.getById(userId, id);\n}\n\nexport async function createDiary(\n  userId: string,\n  payload: DiaryPayload,\n  opts?: { onUploadProgress?: (progress: number) => void }\n): Promise<Diary> {\n  const validation = validateDiaryInput({\n    date: payload.date,\n    content: payload.content,\n  });\n\n  if (!validation.valid) {\n    throw new DiaryValidationError(validation.errors);\n  }\n\n  const draft: DiaryDraft = {\n    userId,\n    date: payload.date,\n    content: payload.content.trim(),\n    aiReviewed: false,\n  };\n\n  if (payload.imageFile) {\n    const { file } = await convertImageToWebP(payload.imageFile);\n    const uploaded = await repository.uploadDiaryImage(\n      file,\n      userId,\n      opts?.onUploadProgress\n    );\n    draft.imageUrl = uploaded.url;\n  }\n\n  return repository.create(draft);\n}\n\nexport async function updateDiary(\n  id: string,\n  userId: string,\n  payload: DiaryPayload,\n  opts?: { onUploadProgress?: (progress: number) => void }\n): Promise<Diary> {\n  const validation = validateDiaryInput({\n    date: payload.date,\n    content: payload.content,\n  });\n\n  if (!validation.valid) {\n    throw new DiaryValidationError(validation.errors);\n  }\n\n  const draft: Partial<DiaryDraft> = {\n    date: payload.date,\n    content: payload.content.trim(),\n  };\n\n  if (payload.removeImage) {\n    draft.imageUrl = \"\";\n  }\n\n  if (payload.imageFile) {\n    const { file } = await convertImageToWebP(payload.imageFile);\n    const uploaded = await repository.uploadDiaryImage(\n      file,\n      userId,\n      opts?.onUploadProgress\n    );\n    draft.imageUrl = uploaded.url;\n  }\n\n  return repository.update(id, draft);\n}\n\nexport async function deleteDiary(id: string) {\n  return repository.delete(id);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAEA;AAMA;AACA;AATA;;;;AAkBO,MAAM,6BAA6B;IACxC,QAAkB;IAClB,YAAY,OAAiB,CAAE;QAC7B,KAAK,CAAC;QACN,IAAI,CAAC,OAAO,GAAG;IACjB;AACF;AAEA,MAAM,aAEF,8MAAuB;AAEpB,eAAe,YAAY,MAAc,EAAE,IAAa;IAC7D,OAAO,WAAW,UAAU,CAAC,QAAQ;AACvC;AAEO,eAAe,SAAS,MAAc,EAAE,EAAU;IACvD,OAAO,WAAW,OAAO,CAAC,QAAQ;AACpC;AAEO,eAAe,YACpB,MAAc,EACd,OAAqB,EACrB,IAAwD;IAExD,MAAM,aAAa,IAAA,uKAAkB,EAAC;QACpC,MAAM,QAAQ,IAAI;QAClB,SAAS,QAAQ,OAAO;IAC1B;IAEA,IAAI,CAAC,WAAW,KAAK,EAAE;QACrB,MAAM,IAAI,qBAAqB,WAAW,MAAM;IAClD;IAEA,MAAM,QAAoB;QACxB;QACA,MAAM,QAAQ,IAAI;QAClB,SAAS,QAAQ,OAAO,CAAC,IAAI;QAC7B,YAAY;IACd;IAEA,IAAI,QAAQ,SAAS,EAAE;QACrB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAA,oKAAkB,EAAC,QAAQ,SAAS;QAC3D,MAAM,WAAW,MAAM,WAAW,gBAAgB,CAChD,MACA,QACA,MAAM;QAER,MAAM,QAAQ,GAAG,SAAS,GAAG;IAC/B;IAEA,OAAO,WAAW,MAAM,CAAC;AAC3B;AAEO,eAAe,YACpB,EAAU,EACV,MAAc,EACd,OAAqB,EACrB,IAAwD;IAExD,MAAM,aAAa,IAAA,uKAAkB,EAAC;QACpC,MAAM,QAAQ,IAAI;QAClB,SAAS,QAAQ,OAAO;IAC1B;IAEA,IAAI,CAAC,WAAW,KAAK,EAAE;QACrB,MAAM,IAAI,qBAAqB,WAAW,MAAM;IAClD;IAEA,MAAM,QAA6B;QACjC,MAAM,QAAQ,IAAI;QAClB,SAAS,QAAQ,OAAO,CAAC,IAAI;IAC/B;IAEA,IAAI,QAAQ,WAAW,EAAE;QACvB,MAAM,QAAQ,GAAG;IACnB;IAEA,IAAI,QAAQ,SAAS,EAAE;QACrB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAA,oKAAkB,EAAC,QAAQ,SAAS;QAC3D,MAAM,WAAW,MAAM,WAAW,gBAAgB,CAChD,MACA,QACA,MAAM;QAER,MAAM,QAAQ,GAAG,SAAS,GAAG;IAC/B;IAEA,OAAO,WAAW,MAAM,CAAC,IAAI;AAC/B;AAEO,eAAe,YAAY,EAAU;IAC1C,OAAO,WAAW,MAAM,CAAC;AAC3B"}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/application/diary/hooks.ts"],"sourcesContent":["\"use client\";\n\nimport { Diary } from \"@/domain/diary\";\nimport {\n  createDiary,\n  deleteDiary,\n  DiaryPayload,\n  getDiary,\n  listDiaries,\n  updateDiary,\n} from \"./diary-service\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\n\nconst listKey = (userId: string, year?: number) => [\n  \"diaries\",\n  userId,\n  year ?? \"all\",\n];\nconst detailKey = (id: string) => [\"diary\", id];\n\nexport function useDiaryList(userId: string, year?: number) {\n  return useQuery({\n    queryKey: listKey(userId, year),\n    queryFn: () => listDiaries(userId, year),\n    enabled: Boolean(userId),\n  });\n}\n\nexport function useDiaryDetail(userId: string, id?: string) {\n  return useQuery({\n    queryKey: detailKey(id || \"new\"),\n    queryFn: () => getDiary(userId, id as string),\n    enabled: Boolean(userId && id),\n  });\n}\n\nexport function useDiaryMutations(userId: string) {\n  const queryClient = useQueryClient();\n  type MutationOptions = DiaryPayload & {\n    onUploadProgress?: (progress: number) => void;\n  };\n\n  const invalidateLists = () =>\n    queryClient.invalidateQueries({ queryKey: [\"diaries\", userId] });\n\n  const updateCachedLists = (\n    updater: (diary: Diary) => Diary | null | undefined\n  ) => {\n    const queries = queryClient.getQueriesData<Diary[]>({\n      queryKey: [\"diaries\", userId],\n    });\n\n    queries.forEach(([key, value]) => {\n      if (!value) return;\n      const next = value\n        .map((item) => updater(item))\n        .filter(Boolean) as Diary[];\n      queryClient.setQueryData(key, next);\n    });\n  };\n\n  const create = useMutation({\n    mutationFn: (payload: MutationOptions) =>\n      createDiary(userId, payload, {\n        onUploadProgress: payload.onUploadProgress,\n      }),\n    onMutate: async (variables: MutationOptions) => {\n      await queryClient.cancelQueries({ queryKey: [\"diaries\", userId] });\n      const previous = queryClient.getQueriesData<Diary[]>({\n        queryKey: [\"diaries\", userId],\n      });\n      const optimistic: Diary = {\n        id: `temp-${Date.now()}`,\n        userId,\n        date: variables.date,\n        content: variables.content,\n        imageUrl: undefined,\n        aiReviewed: false,\n        createdAt: new Date(),\n      };\n      const queries = queryClient.getQueriesData<Diary[]>({\n        queryKey: [\"diaries\", userId],\n      });\n      queries.forEach(([key, value]) => {\n        const next = value ? [optimistic, ...value] : [optimistic];\n        queryClient.setQueryData(key, next);\n      });\n      return { previous };\n    },\n    onError: (_err, _variables, context) => {\n      context?.previous?.forEach(([key, value]) =>\n        queryClient.setQueryData(key, value)\n      );\n    },\n    onSuccess: (data) => {\n      invalidateLists();\n      queryClient.setQueryData(detailKey(data.id), data);\n    },\n  });\n\n  const update = useMutation({\n    mutationFn: (args: { id: string; payload: MutationOptions }) =>\n      updateDiary(args.id, userId, args.payload, {\n        onUploadProgress: args.payload.onUploadProgress,\n      }),\n    onMutate: async ({ id, payload }) => {\n      await queryClient.cancelQueries({ queryKey: [\"diaries\", userId] });\n      const previous = queryClient.getQueriesData<Diary[]>({\n        queryKey: [\"diaries\", userId],\n      });\n\n      updateCachedLists((item) =>\n        item.id === id\n          ? { ...item, content: payload.content, date: payload.date }\n          : item\n      );\n\n      return { previous };\n    },\n    onError: (_err, _vars, context) => {\n      context?.previous?.forEach(([key, value]) =>\n        queryClient.setQueryData(key, value)\n      );\n    },\n    onSuccess: (data) => {\n      invalidateLists();\n      queryClient.setQueryData(detailKey(data.id), data);\n    },\n  });\n\n  const remove = useMutation({\n    mutationFn: (id: string) => deleteDiary(id),\n    onMutate: async (id: string) => {\n      await queryClient.cancelQueries({ queryKey: [\"diaries\", userId] });\n      const previous = queryClient.getQueriesData<Diary[]>({\n        queryKey: [\"diaries\", userId],\n      });\n\n      updateCachedLists((item) => (item.id === id ? null : item));\n\n      return { previous };\n    },\n    onError: (_err, _vars, context) => {\n      context?.previous?.forEach(([key, value]) =>\n        queryClient.setQueryData(key, value)\n      );\n    },\n    onSuccess: () => {\n      invalidateLists();\n    },\n  });\n\n  return { create, update, remove };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 605, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/lib/current-user.ts"],"sourcesContent":["import { auth } from \"@/lib/firebase\";\n\n// Returns Firebase UID if logged in, otherwise a local fallback for demo.\nexport function getCurrentUserId() {\n  if (typeof window !== \"undefined\" && auth.currentUser?.uid) {\n    return auth.currentUser.uid;\n  }\n  return \"demo-user\";\n}\n"],"names":[],"mappings":";;;;AAAA;;AAGO,SAAS;IACd,IAAI,kDAAkB,eAAe,yJAAI,CAAC,WAAW,EAAE;;IAGvD,OAAO;AACT"}},
    {"offset": {"line": 620, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/lib/intl-format.ts"],"sourcesContent":["export function formatDate(value: string | Date, locale: string) {\n  const date = typeof value === \"string\" ? new Date(`${value}T00:00:00`) : value;\n  return new Intl.DateTimeFormat(locale, { year: \"numeric\", month: \"short\", day: \"numeric\" }).format(date);\n}\n\nexport function formatNumber(value: number, locale: string) {\n  return new Intl.NumberFormat(locale).format(value);\n}\n"],"names":[],"mappings":";;;;;;AAAO,SAAS,WAAW,KAAoB,EAAE,MAAc;IAC7D,MAAM,OAAO,OAAO,UAAU,WAAW,IAAI,KAAK,GAAG,MAAM,SAAS,CAAC,IAAI;IACzE,OAAO,IAAI,KAAK,cAAc,CAAC,QAAQ;QAAE,MAAM;QAAW,OAAO;QAAS,KAAK;IAAU,GAAG,MAAM,CAAC;AACrG;AAEO,SAAS,aAAa,KAAa,EAAE,MAAc;IACxD,OAAO,IAAI,KAAK,YAAY,CAAC,QAAQ,MAAM,CAAC;AAC9C"}},
    {"offset": {"line": 641, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/components/auth/AuthGate.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, type ReactNode } from \"react\";\nimport { useAuth } from \"@/application/auth/AuthProvider\";\nimport { Button } from \"@/components/ui/Button\";\nimport { Card, CardContent, CardFooter, CardHeader, CardTitle } from \"@/components/ui/Card\";\nimport { routing } from \"@/i18n/routing\";\nimport { useLocale, useTranslations } from \"next-intl\";\nimport { Languages, Loader2, NotebookPen, ShieldCheck, Sparkles } from \"lucide-react\";\n\ntype AuthGateProps = {\n  children: ReactNode;\n};\n\nexport function AuthGate({ children }: AuthGateProps) {\n  const { user, loading, signInWithGoogle } = useAuth();\n  const t = useTranslations(\"auth\");\n  const locale = useLocale();\n\n  const languageList = useMemo(() => {\n    try {\n      const displayNames = new Intl.DisplayNames([locale], { type: \"language\" });\n      return routing.locales\n        .map((code) => displayNames.of(code) || code)\n        .join(\" · \");\n    } catch (_error) {\n      return routing.locales.join(\" · \");\n    }\n  }, [locale]);\n\n  if (loading) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center gap-3\">\n        <Loader2 className=\"h-6 w-6 animate-spin text-primary\" aria-hidden />\n        <p className=\"text-sm text-muted-foreground\">{t(\"loading\")}</p>\n      </div>\n    );\n  }\n\n  if (!user) {\n    const steps = [\n      { icon: NotebookPen, text: t(\"steps.write\") },\n      { icon: Sparkles, text: t(\"steps.review\") },\n      { icon: ShieldCheck, text: t(\"steps.save\") },\n    ];\n\n    return (\n      <div className=\"flex min-h-screen items-center justify-center px-4 py-10\">\n        <Card className=\"w-full max-w-4xl border-white/10 bg-gradient-to-b from-white/5 to-white/0\">\n          <CardHeader className=\"space-y-3 text-center\">\n            <CardTitle className=\"text-3xl font-bold text-foreground\">{t(\"title\")}</CardTitle>\n            <p className=\"text-sm text-muted-foreground\">{t(\"description\")}</p>\n            <p className=\"text-sm font-medium text-primary\">{t(\"requirement\")}</p>\n            <p className=\"text-xs text-muted-foreground\">{t(\"after_login\")}</p>\n          </CardHeader>\n\n          <CardContent className=\"grid gap-4 md:grid-cols-3\">\n            {steps.map((step) => {\n              const Icon = step.icon;\n              return (\n                <div\n                  key={step.text}\n                  className=\"flex items-start gap-3 rounded-xl border border-white/10 bg-white/5 p-4\"\n                >\n                  <Icon className=\"h-5 w-5 text-primary\" aria-hidden />\n                  <p className=\"text-sm leading-relaxed text-foreground\">{step.text}</p>\n                </div>\n              );\n            })}\n            <div className=\"md:col-span-3\">\n              <div className=\"flex items-start gap-3 rounded-xl border border-white/10 bg-white/5 p-4\">\n                <Languages className=\"h-5 w-5 text-primary\" aria-hidden />\n                <div>\n                  <p className=\"text-sm font-medium text-foreground\">{t(\"languages_label\")}</p>\n                  <p className=\"text-sm text-muted-foreground\">{languageList}</p>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n\n          <CardFooter className=\"flex flex-col items-center gap-3\">\n            <Button\n              size=\"lg\"\n              className=\"w-full bg-primary/90 text-primary-foreground hover:bg-primary md:w-auto\"\n              onClick={() => signInWithGoogle()}\n            >\n              {t(\"cta\")}\n            </Button>\n          </CardFooter>\n        </Card>\n      </div>\n    );\n  }\n\n  return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AARA;;;;;;;;;AAcO,SAAS,SAAS,EAAE,QAAQ,EAAiB;IAClD,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,gBAAgB,EAAE,GAAG,IAAA,iLAAO;IACnD,MAAM,IAAI,IAAA,oOAAe,EAAC;IAC1B,MAAM,SAAS,IAAA,0MAAS;IAExB,MAAM,eAAe,IAAA,2OAAO,EAAC;QAC3B,IAAI;YACF,MAAM,eAAe,IAAI,KAAK,YAAY,CAAC;gBAAC;aAAO,EAAE;gBAAE,MAAM;YAAW;YACxE,OAAO,4JAAO,CAAC,OAAO,CACnB,GAAG,CAAC,CAAC,OAAS,aAAa,EAAE,CAAC,SAAS,MACvC,IAAI,CAAC;QACV,EAAE,OAAO,QAAQ;YACf,OAAO,4JAAO,CAAC,OAAO,CAAC,IAAI,CAAC;QAC9B;IACF,GAAG;QAAC;KAAO;IAEX,IAAI,SAAS;QACX,qBACE,yQAAC;YAAI,WAAU;;8BACb,yQAAC,uPAAO;oBAAC,WAAU;oBAAoC,aAAW;;;;;;8BAClE,yQAAC;oBAAE,WAAU;8BAAiC,EAAE;;;;;;;;;;;;IAGtD;IAEA,IAAI,CAAC,MAAM;QACT,MAAM,QAAQ;YACZ;gBAAE,MAAM,8PAAW;gBAAE,MAAM,EAAE;YAAe;YAC5C;gBAAE,MAAM,iPAAQ;gBAAE,MAAM,EAAE;YAAgB;YAC1C;gBAAE,MAAM,8PAAW;gBAAE,MAAM,EAAE;YAAc;SAC5C;QAED,qBACE,yQAAC;YAAI,WAAU;sBACb,cAAA,yQAAC,mKAAI;gBAAC,WAAU;;kCACd,yQAAC,yKAAU;wBAAC,WAAU;;0CACpB,yQAAC,wKAAS;gCAAC,WAAU;0CAAsC,EAAE;;;;;;0CAC7D,yQAAC;gCAAE,WAAU;0CAAiC,EAAE;;;;;;0CAChD,yQAAC;gCAAE,WAAU;0CAAoC,EAAE;;;;;;0CACnD,yQAAC;gCAAE,WAAU;0CAAiC,EAAE;;;;;;;;;;;;kCAGlD,yQAAC,0KAAW;wBAAC,WAAU;;4BACpB,MAAM,GAAG,CAAC,CAAC;gCACV,MAAM,OAAO,KAAK,IAAI;gCACtB,qBACE,yQAAC;oCAEC,WAAU;;sDAEV,yQAAC;4CAAK,WAAU;4CAAuB,aAAW;;;;;;sDAClD,yQAAC;4CAAE,WAAU;sDAA2C,KAAK,IAAI;;;;;;;mCAJ5D,KAAK,IAAI;;;;;4BAOpB;0CACA,yQAAC;gCAAI,WAAU;0CACb,cAAA,yQAAC;oCAAI,WAAU;;sDACb,yQAAC,oPAAS;4CAAC,WAAU;4CAAuB,aAAW;;;;;;sDACvD,yQAAC;;8DACC,yQAAC;oDAAE,WAAU;8DAAuC,EAAE;;;;;;8DACtD,yQAAC;oDAAE,WAAU;8DAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAMtD,yQAAC,yKAAU;wBAAC,WAAU;kCACpB,cAAA,yQAAC,uKAAM;4BACL,MAAK;4BACL,WAAU;4BACV,SAAS,IAAM;sCAEd,EAAE;;;;;;;;;;;;;;;;;;;;;;IAMf;IAEA,qBAAO;kBAAG;;AACZ"}},
    {"offset": {"line": 895, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/app/%5Blocale%5D/diary/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\nimport { Button } from \"@/components/ui/Button\";\nimport {\n  Card,\n  CardContent,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/Card\";\nimport { Plus, CalendarDays, Edit3, Trash2 } from \"lucide-react\";\nimport { Link } from \"@/i18n/routing\";\nimport { useTranslations, useLocale } from \"next-intl\";\nimport { useDiaryList, useDiaryMutations } from \"@/application/diary/hooks\";\nimport { getCurrentUserId } from \"@/lib/current-user\";\nimport { Diary } from \"@/domain/diary\";\nimport { toast } from \"sonner\";\nimport NextImage from \"next/image\";\nimport { formatDate } from \"@/lib/intl-format\";\nimport { AuthGate } from \"@/components/auth/AuthGate\";\n\nexport default function DiaryListPage() {\n  const t = useTranslations(\"diary\");\n  const locale = useLocale();\n  const userId = getCurrentUserId();\n  const currentYear = new Date().getFullYear();\n  const [year, setYear] = useState(currentYear);\n  const [month, setMonth] = useState<number | null>(null);\n\n  const { data: diaries = [], isLoading } = useDiaryList(userId, year);\n  const { remove } = useDiaryMutations(userId);\n  const monthLabels = useMemo(\n    () =>\n      Array.from({ length: 12 }, (_, idx) =>\n        new Intl.DateTimeFormat(locale, { month: \"short\" }).format(new Date(2020, idx, 1))\n      ),\n    [locale]\n  );\n\n  const yearOptions = useMemo(() => {\n    const years = new Set<number>();\n    diaries.forEach((diary) => years.add(Number(diary.date.split(\"-\")[0])));\n    years.add(currentYear);\n    return Array.from(years).sort((a, b) => b - a);\n  }, [diaries, currentYear]);\n\n  const monthCounts = useMemo(() => {\n    const counts: Record<number, number> = {};\n    diaries.forEach((diary) => {\n      const m = new Date(`${diary.date}T00:00:00`).getMonth();\n      counts[m] = (counts[m] || 0) + 1;\n    });\n    return counts;\n  }, [diaries]);\n\n  const filtered = useMemo(() => {\n    if (month === null) return diaries;\n    return diaries.filter(\n      (diary) => new Date(`${diary.date}T00:00:00`).getMonth() === month\n    );\n  }, [diaries, month]);\n\n  const handleDelete = async (diary: Diary) => {\n    if (!confirm(t(\"confirm_delete\"))) return;\n    try {\n      await remove.mutateAsync(diary.id);\n      toast.success(t(\"delete_success\"));\n    } catch {\n      toast.error(t(\"delete_error\"));\n    }\n  };\n\n  return (\n    <AuthGate>\n      <div className=\"space-y-8\">\n        <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n          <div className=\"space-y-1\">\n            <h1 className=\"text-3xl font-bold text-foreground\">{t(\"title\")}</h1>\n            <p className=\"text-sm text-muted-foreground\">{t(\"subtitle\")}</p>\n          </div>\n        <Link href=\"/diary/new\">\n          <Button>\n            <Plus className=\"mr-2 h-4 w-4\" />\n            {t(\"new_entry\")}\n          </Button>\n        </Link>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-3\">\n        <Card className=\"md:col-span-1\">\n          <CardHeader className=\"flex flex-row items-center justify-between\">\n            <CardTitle className=\"text-sm text-muted-foreground\">\n              {t(\"filter_year\")}\n            </CardTitle>\n            <CalendarDays className=\"h-4 w-4 text-primary\" />\n          </CardHeader>\n          <CardContent className=\"space-y-2\">\n            <select\n              className=\"w-full rounded-lg border border-white/10 bg-white/5 p-2 text-sm\"\n              value={year}\n              onChange={(e) => setYear(Number(e.target.value))}\n            >\n              {yearOptions.map((option) => (\n                <option key={option} value={option}>\n                  {option}\n                </option>\n              ))}\n            </select>\n            <p className=\"text-xs text-muted-foreground\">{t(\"filter_month\")}</p>\n            <div className=\"grid grid-cols-3 gap-2 text-sm\">\n              <button\n                className={`rounded-md border border-white/10 px-3 py-2 text-left transition ${\n                  month === null\n                    ? \"bg-primary/20 text-primary-foreground\"\n                    : \"hover:bg-white/5\"\n                }`}\n                onClick={() => setMonth(null)}\n              >\n                {t(\"all_months\")}\n              </button>\n              {monthLabels.map((label, index) => (\n                <button\n                  key={label}\n                  className={`rounded-md border border-white/10 px-3 py-2 text-left transition ${\n                    month === index\n                      ? \"bg-primary/20 text-primary-foreground\"\n                      : \"hover:bg-white/5\"\n                  }`}\n                  onClick={() => setMonth(index)}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <span>{label}</span>\n                    <span className=\"text-xs text-muted-foreground\">\n                      {monthCounts[index] || 0}\n                    </span>\n                  </div>\n                </button>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"md:col-span-2 space-y-4\">\n          {isLoading ? (\n            <Card className=\"border-dashed bg-transparent p-6 text-center\">\n              <p className=\"text-muted-foreground\">{t(\"loading\")}</p>\n            </Card>\n          ) : filtered.length === 0 ? (\n            <Card className=\"flex min-h-[200px] flex-col items-center justify-center border-dashed bg-transparent text-center\">\n              <p className=\"text-muted-foreground\">{t(\"empty\")}</p>\n              <Link href=\"/diary/new\" className=\"mt-3 inline-flex\">\n                <Button size=\"sm\">\n                  <Plus className=\"mr-2 h-4 w-4\" />\n                  {t(\"new_entry\")}\n                </Button>\n              </Link>\n            </Card>\n          ) : (\n            <div className=\"grid gap-4\">\n              {filtered.map((diary) => (\n                <Card key={diary.id} className=\"glass-card border-white/10\">\n                  <CardHeader className=\"flex flex-row items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {formatDate(diary.date, locale)}\n                      </p>\n                      <CardTitle className=\"line-clamp-1 text-xl\">\n                        {diary.content.slice(0, 40) || t(\"untitled\")}\n                      </CardTitle>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Link href={`/diary/${diary.id}`}>\n                        <Button variant=\"secondary\" size=\"sm\">\n                          <Edit3 className=\"mr-2 h-4 w-4\" />\n                          {t(\"edit\")}\n                        </Button>\n                      </Link>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleDelete(diary)}\n                        disabled={remove.isPending}\n                      >\n                        <Trash2 className=\"mr-2 h-4 w-4\" />\n                        {t(\"delete\")}\n                      </Button>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"space-y-3\">\n                    {diary.imageUrl && (\n                      <NextImage\n                        src={diary.imageUrl}\n                        alt=\"Diary attachment\"\n                        width={1200}\n                        height={800}\n                        className=\"h-48 w-full rounded-lg object-cover\"\n                        loading=\"lazy\"\n                        sizes=\"(max-width: 768px) 100vw, 700px\"\n                      />\n                    )}\n                    <p className=\"line-clamp-3 text-sm leading-relaxed text-muted-foreground\">\n                      {diary.content}\n                    </p>\n                  </CardContent>\n                  <CardFooter className=\"flex items-center justify-between text-xs text-muted-foreground\">\n                    <span>\n                      {t(\"year_label\")}: {diary.date.split(\"-\")[0]}\n                    </span>\n                    <span>\n                      {t(\"month_label\")}: {monthLabels[new Date(`${diary.date}T00:00:00`).getMonth()]}\n                    </span>\n                  </CardFooter>\n                </Card>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n      </div>\n    </AuthGate>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}