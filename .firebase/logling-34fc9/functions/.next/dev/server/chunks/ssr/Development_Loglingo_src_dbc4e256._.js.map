{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/domain/diary.ts"],"sourcesContent":["export interface Diary {\n  id: string;\n  userId: string;\n  date: string; // yyyy-mm-dd\n  content: string;\n  imageUrl?: string;\n  aiReviewed: boolean;\n  createdAt: Date;\n  updatedAt?: Date;\n}\n\nexport interface DiaryDraft {\n  userId: string;\n  date: string;\n  content: string;\n  imageUrl?: string;\n  aiReviewed?: boolean;\n}\n\nexport interface DiaryImageUploadResult {\n  url: string;\n  path: string;\n}\n\nexport interface DiaryRepository {\n  listByUser(userId: string, year?: number): Promise<Diary[]>;\n  getById(userId: string, id: string): Promise<Diary | null>;\n  create(input: DiaryDraft): Promise<Diary>;\n  update(id: string, input: Partial<DiaryDraft>): Promise<Diary>;\n  delete(id: string): Promise<void>;\n}\n\nexport function validateDiaryInput(input: Pick<DiaryDraft, \"date\" | \"content\">) {\n  const errors: string[] = [];\n\n  if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(input.date)) {\n    errors.push(\"invalid-date\");\n  }\n\n  const trimmed = input.content.trim();\n  if (!trimmed) {\n    errors.push(\"empty-content\");\n  }\n\n  if (trimmed.length > 5000) {\n    errors.push(\"too-long\");\n  }\n\n  return { valid: errors.length === 0, errors };\n}\n"],"names":[],"mappings":";;;;AAgCO,SAAS,mBAAmB,KAA2C;IAC5E,MAAM,SAAmB,EAAE;IAE3B,IAAI,CAAC,sBAAsB,IAAI,CAAC,MAAM,IAAI,GAAG;QAC3C,OAAO,IAAI,CAAC;IACd;IAEA,MAAM,UAAU,MAAM,OAAO,CAAC,IAAI;IAClC,IAAI,CAAC,SAAS;QACZ,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,QAAQ,MAAM,GAAG,MAAM;QACzB,OAAO,IAAI,CAAC;IACd;IAEA,OAAO;QAAE,OAAO,OAAO,MAAM,KAAK;QAAG;IAAO;AAC9C"}},
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/lib/image.ts"],"sourcesContent":["\"use client\";\n\nconst MAX_DIMENSION = 1600;\nconst MAX_SIZE_BYTES = 300 * 1024;\n\nexport interface ImageConversionResult {\n  file: File;\n  previewUrl: string;\n}\n\nexport async function convertImageToWebP(file: File): Promise<ImageConversionResult> {\n  if (typeof window === \"undefined\") {\n    throw new Error(\"Image conversion is only available in the browser.\");\n  }\n\n  const image = await loadImage(file);\n  const canvas = document.createElement(\"canvas\");\n  const context = canvas.getContext(\"2d\");\n\n  if (!context) {\n    throw new Error(\"Failed to acquire 2D context for image conversion.\");\n  }\n\n  const scale = Math.min(1, MAX_DIMENSION / Math.max(image.width, image.height));\n  canvas.width = Math.max(1, Math.round(image.width * scale));\n  canvas.height = Math.max(1, Math.round(image.height * scale));\n\n  context.drawImage(image, 0, 0, canvas.width, canvas.height);\n\n  let quality = 0.9;\n  let blob = await toWebPBlob(canvas, quality);\n\n  while (blob && blob.size > MAX_SIZE_BYTES && quality > 0.4) {\n    quality -= 0.1;\n    blob = await toWebPBlob(canvas, quality);\n  }\n\n  if (blob && blob.size > MAX_SIZE_BYTES) {\n    blob = await toWebPBlob(canvas, 0.3);\n  }\n\n  if (!blob) {\n    throw new Error(\"Failed to generate image blob.\");\n  }\n\n  const optimizedFile = new File([blob], replaceExtension(file.name, \"webp\"), {\n    type: \"image/webp\",\n  });\n\n  return {\n    file: optimizedFile,\n    previewUrl: canvas.toDataURL(\"image/webp\", 0.8),\n  };\n}\n\nexport function getImagePreview(file: File): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => resolve(reader.result as string);\n    reader.onerror = () => reject(new Error(\"Failed to read image preview\"));\n    reader.readAsDataURL(file);\n  });\n}\n\nasync function loadImage(file: File): Promise<HTMLImageElement> {\n  const src = await getImagePreview(file);\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => resolve(img);\n    img.onerror = () => reject(new Error(\"Failed to load image\"));\n    img.src = src;\n  });\n}\n\nfunction replaceExtension(name: string, ext: string) {\n  const base = name.includes(\".\") ? name.substring(0, name.lastIndexOf(\".\")) : name;\n  return `${base}.${ext}`;\n}\n\nfunction toWebPBlob(canvas: HTMLCanvasElement, quality: number): Promise<Blob | null> {\n  return new Promise((resolve) => {\n    canvas.toBlob(\n      (blob) => resolve(blob),\n      \"image/webp\",\n      Math.max(0.2, Math.min(1, quality))\n    );\n  });\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAEA,MAAM,gBAAgB;AACtB,MAAM,iBAAiB,MAAM;AAOtB,eAAe,mBAAmB,IAAU;IACjD,wCAAmC;QACjC,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,QAAQ,MAAM,UAAU;IAC9B,MAAM,SAAS,SAAS,aAAa,CAAC;IACtC,MAAM,UAAU,OAAO,UAAU,CAAC;IAElC,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,QAAQ,KAAK,GAAG,CAAC,GAAG,gBAAgB,KAAK,GAAG,CAAC,MAAM,KAAK,EAAE,MAAM,MAAM;IAC5E,OAAO,KAAK,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,MAAM,KAAK,GAAG;IACpD,OAAO,MAAM,GAAG,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC,MAAM,MAAM,GAAG;IAEtD,QAAQ,SAAS,CAAC,OAAO,GAAG,GAAG,OAAO,KAAK,EAAE,OAAO,MAAM;IAE1D,IAAI,UAAU;IACd,IAAI,OAAO,MAAM,WAAW,QAAQ;IAEpC,MAAO,QAAQ,KAAK,IAAI,GAAG,kBAAkB,UAAU,IAAK;QAC1D,WAAW;QACX,OAAO,MAAM,WAAW,QAAQ;IAClC;IAEA,IAAI,QAAQ,KAAK,IAAI,GAAG,gBAAgB;QACtC,OAAO,MAAM,WAAW,QAAQ;IAClC;IAEA,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,gBAAgB,IAAI,KAAK;QAAC;KAAK,EAAE,iBAAiB,KAAK,IAAI,EAAE,SAAS;QAC1E,MAAM;IACR;IAEA,OAAO;QACL,MAAM;QACN,YAAY,OAAO,SAAS,CAAC,cAAc;IAC7C;AACF;AAEO,SAAS,gBAAgB,IAAU;IACxC,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,SAAS,IAAI;QACnB,OAAO,MAAM,GAAG,IAAM,QAAQ,OAAO,MAAM;QAC3C,OAAO,OAAO,GAAG,IAAM,OAAO,IAAI,MAAM;QACxC,OAAO,aAAa,CAAC;IACvB;AACF;AAEA,eAAe,UAAU,IAAU;IACjC,MAAM,MAAM,MAAM,gBAAgB;IAClC,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,MAAM,IAAI;QAChB,IAAI,MAAM,GAAG,IAAM,QAAQ;QAC3B,IAAI,OAAO,GAAG,IAAM,OAAO,IAAI,MAAM;QACrC,IAAI,GAAG,GAAG;IACZ;AACF;AAEA,SAAS,iBAAiB,IAAY,EAAE,GAAW;IACjD,MAAM,OAAO,KAAK,QAAQ,CAAC,OAAO,KAAK,SAAS,CAAC,GAAG,KAAK,WAAW,CAAC,QAAQ;IAC7E,OAAO,GAAG,KAAK,CAAC,EAAE,KAAK;AACzB;AAEA,SAAS,WAAW,MAAyB,EAAE,OAAe;IAC5D,OAAO,IAAI,QAAQ,CAAC;QAClB,OAAO,MAAM,CACX,CAAC,OAAS,QAAQ,OAClB,cACA,KAAK,GAAG,CAAC,KAAK,KAAK,GAAG,CAAC,GAAG;IAE9B;AACF"}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/infrastructure/firebase/diary-repository.ts"],"sourcesContent":["import {\n  Diary,\n  DiaryDraft,\n  DiaryImageUploadResult,\n  DiaryRepository,\n} from \"@/domain/diary\";\nimport { db, storage } from \"@/lib/firebase\";\nimport {\n  addDoc,\n  collection,\n  DocumentData,\n  deleteDoc,\n  doc,\n  getDoc,\n  getDocs,\n  orderBy,\n  query,\n  type DocumentSnapshot,\n  type QueryDocumentSnapshot,\n  serverTimestamp,\n  Timestamp,\n  updateDoc,\n  where,\n} from \"firebase/firestore\";\nimport {\n  getDownloadURL,\n  ref,\n  uploadBytesResumable,\n  UploadTask,\n} from \"firebase/storage\";\n\nconst diariesCollection = collection(db, \"diaries\");\n\nfunction mapDiary(\n  snapshot: DocumentSnapshot<DocumentData> | QueryDocumentSnapshot<DocumentData>\n): Diary {\n  const data = snapshot.data();\n  if (!data) {\n    throw new Error(\"Diary snapshot is missing data\");\n  }\n  const createdAt =\n    data.createdAt instanceof Timestamp\n      ? data.createdAt.toDate()\n      : new Date(data.createdAt ?? Date.now());\n\n  const updatedAt =\n    data.updatedAt instanceof Timestamp\n      ? data.updatedAt.toDate()\n      : data.updatedAt\n      ? new Date(data.updatedAt)\n      : undefined;\n\n  return {\n    id: snapshot.id,\n    userId: data.userId,\n    date: data.date,\n    content: data.content,\n    imageUrl: data.imageUrl,\n    aiReviewed: Boolean(data.aiReviewed),\n    createdAt,\n    updatedAt,\n  };\n}\n\nasync function listByUser(userId: string, year?: number): Promise<Diary[]> {\n  console.log(\"üîç Diary Repository: listByUser called\", { userId, year });\n  \n  if (!userId) {\n    console.log(\"‚ö†Ô∏è Diary Repository: No userId, returning empty array\");\n    return [];\n  }\n\n  try {\n    const constraints = [where(\"userId\", \"==\", userId)];\n    if (year) {\n      constraints.push(where(\"date\", \">=\", `${year}-01-01`));\n      constraints.push(where(\"date\", \"<=\", `${year}-12-31`));\n    }\n\n    // orderByÎ•º ÏûÑÏãúÎ°ú Ï†úÍ±∞ÌïòÏó¨ Ïù∏Îç±Ïä§ Î¨∏Ï†úÏù∏ÏßÄ ÌôïÏù∏\n    const q = query(diariesCollection, ...constraints);\n\n    console.log(\"üîç Diary Repository: Executing query...\");\n    const snapshot = await getDocs(q);\n    const results = snapshot.docs.map(mapDiary);\n    \n    // ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ÏÇ¨Ïù¥ÎìúÏóêÏÑú Ï†ïÎ†¨\n    results.sort((a, b) => b.date.localeCompare(a.date));\n    \n    console.log(\"‚úÖ Diary Repository: Query complete\", { count: results.length, results: results.slice(0, 2) });\n    return results;\n  } catch (error) {\n    console.error(\"‚ùå Diary Repository: Query failed\", error);\n    throw error;\n  }\n}\n\nasync function getById(userId: string, id: string): Promise<Diary | null> {\n  const refDoc = doc(diariesCollection, id);\n  const snapshot = await getDoc(refDoc);\n  if (!snapshot.exists()) return null;\n  const data = mapDiary(snapshot);\n  if (data.userId !== userId) return null;\n  return data;\n}\n\nasync function create(input: DiaryDraft): Promise<Diary> {\n  const payload = {\n    ...input,\n    aiReviewed: Boolean(input.aiReviewed),\n    createdAt: serverTimestamp(),\n    updatedAt: serverTimestamp(),\n  };\n\n  const refDoc = await addDoc(diariesCollection, payload);\n  const created = await getDoc(refDoc);\n  return mapDiary(created);\n}\n\nasync function update(id: string, input: Partial<DiaryDraft>): Promise<Diary> {\n  const refDoc = doc(diariesCollection, id);\n  await updateDoc(refDoc, { ...input, updatedAt: serverTimestamp() });\n  const updated = await getDoc(refDoc);\n  return mapDiary(updated);\n}\n\nasync function remove(id: string): Promise<void> {\n  const refDoc = doc(diariesCollection, id);\n  await deleteDoc(refDoc);\n}\n\nasync function uploadDiaryImage(\n  file: File,\n  userId: string,\n  onProgress?: (progress: number) => void\n): Promise<DiaryImageUploadResult> {\n  const safeName = file.name.replace(/\\s+/g, \"-\").toLowerCase();\n  const storageRef = ref(\n    storage,\n    `diaryImages/${userId}/${Date.now()}-${safeName}`\n  );\n  const uploadTask: UploadTask = uploadBytesResumable(storageRef, file, {\n    contentType: file.type,\n    cacheControl: \"public,max-age=31536000\",\n  });\n\n  return new Promise((resolve, reject) => {\n    uploadTask.on(\n      \"state_changed\",\n      (snapshot) => {\n        const progress = Math.round(\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n        );\n        onProgress?.(progress);\n      },\n      (error) => reject(error),\n      async () => {\n        const url = await getDownloadURL(uploadTask.snapshot.ref);\n        resolve({ url, path: uploadTask.snapshot.ref.fullPath });\n      }\n    );\n  });\n}\n\nexport const firebaseDiaryRepository: DiaryRepository & {\n  uploadDiaryImage: typeof uploadDiaryImage;\n} = {\n  listByUser,\n  getById,\n  create,\n  update,\n  delete: remove,\n  uploadDiaryImage,\n};\n"],"names":[],"mappings":";;;;AAMA;AACA;AAAA;AAiBA;AAAA;;;;AAOA,MAAM,oBAAoB,IAAA,0MAAU,EAAC,uJAAE,EAAE;AAEzC,SAAS,SACP,QAA8E;IAE9E,MAAM,OAAO,SAAS,IAAI;IAC1B,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM;IAClB;IACA,MAAM,YACJ,KAAK,SAAS,YAAY,yMAAS,GAC/B,KAAK,SAAS,CAAC,MAAM,KACrB,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,GAAG;IAEzC,MAAM,YACJ,KAAK,SAAS,YAAY,yMAAS,GAC/B,KAAK,SAAS,CAAC,MAAM,KACrB,KAAK,SAAS,GACd,IAAI,KAAK,KAAK,SAAS,IACvB;IAEN,OAAO;QACL,IAAI,SAAS,EAAE;QACf,QAAQ,KAAK,MAAM;QACnB,MAAM,KAAK,IAAI;QACf,SAAS,KAAK,OAAO;QACrB,UAAU,KAAK,QAAQ;QACvB,YAAY,QAAQ,KAAK,UAAU;QACnC;QACA;IACF;AACF;AAEA,eAAe,WAAW,MAAc,EAAE,IAAa;IACrD,QAAQ,GAAG,CAAC,0CAA0C;QAAE;QAAQ;IAAK;IAErE,IAAI,CAAC,QAAQ;QACX,QAAQ,GAAG,CAAC;QACZ,OAAO,EAAE;IACX;IAEA,IAAI;QACF,MAAM,cAAc;YAAC,IAAA,qMAAK,EAAC,UAAU,MAAM;SAAQ;QACnD,IAAI,MAAM;YACR,YAAY,IAAI,CAAC,IAAA,qMAAK,EAAC,QAAQ,MAAM,GAAG,KAAK,MAAM,CAAC;YACpD,YAAY,IAAI,CAAC,IAAA,qMAAK,EAAC,QAAQ,MAAM,GAAG,KAAK,MAAM,CAAC;QACtD;QAEA,gCAAgC;QAChC,MAAM,IAAI,IAAA,qMAAK,EAAC,sBAAsB;QAEtC,QAAQ,GAAG,CAAC;QACZ,MAAM,WAAW,MAAM,IAAA,uMAAO,EAAC;QAC/B,MAAM,UAAU,SAAS,IAAI,CAAC,GAAG,CAAC;QAElC,iBAAiB;QACjB,QAAQ,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI;QAElD,QAAQ,GAAG,CAAC,sCAAsC;YAAE,OAAO,QAAQ,MAAM;YAAE,SAAS,QAAQ,KAAK,CAAC,GAAG;QAAG;QACxG,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oCAAoC;QAClD,MAAM;IACR;AACF;AAEA,eAAe,QAAQ,MAAc,EAAE,EAAU;IAC/C,MAAM,SAAS,IAAA,mMAAG,EAAC,mBAAmB;IACtC,MAAM,WAAW,MAAM,IAAA,sMAAM,EAAC;IAC9B,IAAI,CAAC,SAAS,MAAM,IAAI,OAAO;IAC/B,MAAM,OAAO,SAAS;IACtB,IAAI,KAAK,MAAM,KAAK,QAAQ,OAAO;IACnC,OAAO;AACT;AAEA,eAAe,OAAO,KAAiB;IACrC,MAAM,UAAU;QACd,GAAG,KAAK;QACR,YAAY,QAAQ,MAAM,UAAU;QACpC,WAAW,IAAA,+MAAe;QAC1B,WAAW,IAAA,+MAAe;IAC5B;IAEA,MAAM,SAAS,MAAM,IAAA,sMAAM,EAAC,mBAAmB;IAC/C,MAAM,UAAU,MAAM,IAAA,sMAAM,EAAC;IAC7B,OAAO,SAAS;AAClB;AAEA,eAAe,OAAO,EAAU,EAAE,KAA0B;IAC1D,MAAM,SAAS,IAAA,mMAAG,EAAC,mBAAmB;IACtC,MAAM,IAAA,yMAAS,EAAC,QAAQ;QAAE,GAAG,KAAK;QAAE,WAAW,IAAA,+MAAe;IAAG;IACjE,MAAM,UAAU,MAAM,IAAA,sMAAM,EAAC;IAC7B,OAAO,SAAS;AAClB;AAEA,eAAe,OAAO,EAAU;IAC9B,MAAM,SAAS,IAAA,mMAAG,EAAC,mBAAmB;IACtC,MAAM,IAAA,yMAAS,EAAC;AAClB;AAEA,eAAe,iBACb,IAAU,EACV,MAAc,EACd,UAAuC;IAEvC,MAAM,WAAW,KAAK,IAAI,CAAC,OAAO,CAAC,QAAQ,KAAK,WAAW;IAC3D,MAAM,aAAa,IAAA,sNAAG,EACpB,4JAAO,EACP,CAAC,YAAY,EAAE,OAAO,CAAC,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,UAAU;IAEnD,MAAM,aAAyB,IAAA,uOAAoB,EAAC,YAAY,MAAM;QACpE,aAAa,KAAK,IAAI;QACtB,cAAc;IAChB;IAEA,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,WAAW,EAAE,CACX,iBACA,CAAC;YACC,MAAM,WAAW,KAAK,KAAK,CACzB,AAAC,SAAS,gBAAgB,GAAG,SAAS,UAAU,GAAI;YAEtD,aAAa;QACf,GACA,CAAC,QAAU,OAAO,QAClB;YACE,MAAM,MAAM,MAAM,IAAA,iOAAc,EAAC,WAAW,QAAQ,CAAC,GAAG;YACxD,QAAQ;gBAAE;gBAAK,MAAM,WAAW,QAAQ,CAAC,GAAG,CAAC,QAAQ;YAAC;QACxD;IAEJ;AACF;AAEO,MAAM,0BAET;IACF;IACA;IACA;IACA;IACA,QAAQ;IACR;AACF"}},
    {"offset": {"line": 233, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/application/diary/diary-service.ts"],"sourcesContent":["\"use client\";\n\nimport {\n  Diary,\n  DiaryDraft,\n  DiaryRepository,\n  validateDiaryInput,\n} from \"@/domain/diary\";\nimport { convertImageToWebP } from \"@/lib/image\";\nimport { firebaseDiaryRepository } from \"@/infrastructure/firebase/diary-repository\";\n\nexport interface DiaryPayload {\n  date: string;\n  content: string;\n  imageFile?: File | null;\n  removeImage?: boolean;\n}\n\nexport class DiaryValidationError extends Error {\n  reasons: string[];\n  constructor(reasons: string[]) {\n    super(\"Invalid diary input\");\n    this.reasons = reasons;\n  }\n}\n\nconst repository: DiaryRepository & {\n  uploadDiaryImage: typeof firebaseDiaryRepository.uploadDiaryImage;\n} = firebaseDiaryRepository;\n\nexport async function listDiaries(userId: string, year?: number) {\n  return repository.listByUser(userId, year);\n}\n\nexport async function getDiary(userId: string, id: string) {\n  return repository.getById(userId, id);\n}\n\nexport async function createDiary(\n  userId: string,\n  payload: DiaryPayload,\n  opts?: { onUploadProgress?: (progress: number) => void }\n): Promise<Diary> {\n  const validation = validateDiaryInput({\n    date: payload.date,\n    content: payload.content,\n  });\n\n  if (!validation.valid) {\n    throw new DiaryValidationError(validation.errors);\n  }\n\n  const draft: DiaryDraft = {\n    userId,\n    date: payload.date,\n    content: payload.content.trim(),\n    aiReviewed: false,\n  };\n\n  if (payload.imageFile) {\n    const { file } = await convertImageToWebP(payload.imageFile);\n    const uploaded = await repository.uploadDiaryImage(\n      file,\n      userId,\n      opts?.onUploadProgress\n    );\n    draft.imageUrl = uploaded.url;\n  }\n\n  return repository.create(draft);\n}\n\nexport async function updateDiary(\n  id: string,\n  userId: string,\n  payload: DiaryPayload,\n  opts?: { onUploadProgress?: (progress: number) => void }\n): Promise<Diary> {\n  const validation = validateDiaryInput({\n    date: payload.date,\n    content: payload.content,\n  });\n\n  if (!validation.valid) {\n    throw new DiaryValidationError(validation.errors);\n  }\n\n  const draft: Partial<DiaryDraft> = {\n    date: payload.date,\n    content: payload.content.trim(),\n  };\n\n  if (payload.removeImage) {\n    draft.imageUrl = \"\";\n  }\n\n  if (payload.imageFile) {\n    const { file } = await convertImageToWebP(payload.imageFile);\n    const uploaded = await repository.uploadDiaryImage(\n      file,\n      userId,\n      opts?.onUploadProgress\n    );\n    draft.imageUrl = uploaded.url;\n  }\n\n  return repository.update(id, draft);\n}\n\nexport async function deleteDiary(id: string) {\n  return repository.delete(id);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAEA;AAMA;AACA;AATA;;;;AAkBO,MAAM,6BAA6B;IACxC,QAAkB;IAClB,YAAY,OAAiB,CAAE;QAC7B,KAAK,CAAC;QACN,IAAI,CAAC,OAAO,GAAG;IACjB;AACF;AAEA,MAAM,aAEF,8MAAuB;AAEpB,eAAe,YAAY,MAAc,EAAE,IAAa;IAC7D,OAAO,WAAW,UAAU,CAAC,QAAQ;AACvC;AAEO,eAAe,SAAS,MAAc,EAAE,EAAU;IACvD,OAAO,WAAW,OAAO,CAAC,QAAQ;AACpC;AAEO,eAAe,YACpB,MAAc,EACd,OAAqB,EACrB,IAAwD;IAExD,MAAM,aAAa,IAAA,uKAAkB,EAAC;QACpC,MAAM,QAAQ,IAAI;QAClB,SAAS,QAAQ,OAAO;IAC1B;IAEA,IAAI,CAAC,WAAW,KAAK,EAAE;QACrB,MAAM,IAAI,qBAAqB,WAAW,MAAM;IAClD;IAEA,MAAM,QAAoB;QACxB;QACA,MAAM,QAAQ,IAAI;QAClB,SAAS,QAAQ,OAAO,CAAC,IAAI;QAC7B,YAAY;IACd;IAEA,IAAI,QAAQ,SAAS,EAAE;QACrB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAA,oKAAkB,EAAC,QAAQ,SAAS;QAC3D,MAAM,WAAW,MAAM,WAAW,gBAAgB,CAChD,MACA,QACA,MAAM;QAER,MAAM,QAAQ,GAAG,SAAS,GAAG;IAC/B;IAEA,OAAO,WAAW,MAAM,CAAC;AAC3B;AAEO,eAAe,YACpB,EAAU,EACV,MAAc,EACd,OAAqB,EACrB,IAAwD;IAExD,MAAM,aAAa,IAAA,uKAAkB,EAAC;QACpC,MAAM,QAAQ,IAAI;QAClB,SAAS,QAAQ,OAAO;IAC1B;IAEA,IAAI,CAAC,WAAW,KAAK,EAAE;QACrB,MAAM,IAAI,qBAAqB,WAAW,MAAM;IAClD;IAEA,MAAM,QAA6B;QACjC,MAAM,QAAQ,IAAI;QAClB,SAAS,QAAQ,OAAO,CAAC,IAAI;IAC/B;IAEA,IAAI,QAAQ,WAAW,EAAE;QACvB,MAAM,QAAQ,GAAG;IACnB;IAEA,IAAI,QAAQ,SAAS,EAAE;QACrB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAA,oKAAkB,EAAC,QAAQ,SAAS;QAC3D,MAAM,WAAW,MAAM,WAAW,gBAAgB,CAChD,MACA,QACA,MAAM;QAER,MAAM,QAAQ,GAAG,SAAS,GAAG;IAC/B;IAEA,OAAO,WAAW,MAAM,CAAC,IAAI;AAC/B;AAEO,eAAe,YAAY,EAAU;IAC1C,OAAO,WAAW,MAAM,CAAC;AAC3B"}},
    {"offset": {"line": 318, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/application/diary/hooks.ts"],"sourcesContent":["\"use client\";\n\nimport { Diary } from \"@/domain/diary\";\nimport {\n  createDiary,\n  deleteDiary,\n  DiaryPayload,\n  getDiary,\n  listDiaries,\n  updateDiary,\n} from \"./diary-service\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\n\nconst listKey = (userId: string, year?: number) => [\n  \"diaries\",\n  userId,\n  year ?? \"all\",\n];\nconst detailKey = (id: string) => [\"diary\", id];\n\nexport function useDiaryList(userId: string, year?: number, opts?: { enabled?: boolean }) {\n  return useQuery({\n    queryKey: listKey(userId, year),\n    queryFn: () => listDiaries(userId, year),\n    enabled: Boolean(userId) && (opts?.enabled ?? true),\n    refetchOnMount: true,\n  });\n}\n\nexport function useDiaryDetail(userId: string, id?: string) {\n  return useQuery({\n    queryKey: detailKey(id || \"new\"),\n    queryFn: () => getDiary(userId, id as string),\n    enabled: Boolean(userId && id),\n  });\n}\n\nexport function useDiaryMutations(userId: string) {\n  const queryClient = useQueryClient();\n  type MutationOptions = DiaryPayload & {\n    onUploadProgress?: (progress: number) => void;\n  };\n\n  const invalidateLists = () =>\n    queryClient.invalidateQueries({ queryKey: [\"diaries\", userId] });\n\n  const updateCachedLists = (\n    updater: (diary: Diary) => Diary | null | undefined\n  ) => {\n    const queries = queryClient.getQueriesData<Diary[]>({\n      queryKey: [\"diaries\", userId],\n    });\n\n    queries.forEach(([key, value]) => {\n      if (!value) return;\n      const next = value\n        .map((item) => updater(item))\n        .filter(Boolean) as Diary[];\n      queryClient.setQueryData(key, next);\n    });\n  };\n\n  const create = useMutation({\n    mutationFn: (payload: MutationOptions) =>\n      createDiary(userId, payload, {\n        onUploadProgress: payload.onUploadProgress,\n      }),\n    onMutate: async (variables: MutationOptions) => {\n      await queryClient.cancelQueries({ queryKey: [\"diaries\", userId] });\n      const previous = queryClient.getQueriesData<Diary[]>({\n        queryKey: [\"diaries\", userId],\n      });\n      const optimistic: Diary = {\n        id: `temp-${Date.now()}`,\n        userId,\n        date: variables.date,\n        content: variables.content,\n        imageUrl: undefined,\n        aiReviewed: false,\n        createdAt: new Date(),\n      };\n      const queries = queryClient.getQueriesData<Diary[]>({\n        queryKey: [\"diaries\", userId],\n      });\n      queries.forEach(([key, value]) => {\n        const next = value ? [optimistic, ...value] : [optimistic];\n        queryClient.setQueryData(key, next);\n      });\n      return { previous };\n    },\n    onError: (_err, _variables, context) => {\n      context?.previous?.forEach(([key, value]) =>\n        queryClient.setQueryData(key, value)\n      );\n    },\n    onSuccess: (data) => {\n      invalidateLists();\n      queryClient.setQueryData(detailKey(data.id), data);\n    },\n  });\n\n  const update = useMutation({\n    mutationFn: (args: { id: string; payload: MutationOptions }) =>\n      updateDiary(args.id, userId, args.payload, {\n        onUploadProgress: args.payload.onUploadProgress,\n      }),\n    onMutate: async ({ id, payload }) => {\n      await queryClient.cancelQueries({ queryKey: [\"diaries\", userId] });\n      const previous = queryClient.getQueriesData<Diary[]>({\n        queryKey: [\"diaries\", userId],\n      });\n\n      updateCachedLists((item) =>\n        item.id === id\n          ? { ...item, content: payload.content, date: payload.date }\n          : item\n      );\n\n      return { previous };\n    },\n    onError: (_err, _vars, context) => {\n      context?.previous?.forEach(([key, value]) =>\n        queryClient.setQueryData(key, value)\n      );\n    },\n    onSuccess: (data) => {\n      invalidateLists();\n      queryClient.setQueryData(detailKey(data.id), data);\n    },\n  });\n\n  const remove = useMutation({\n    mutationFn: (id: string) => deleteDiary(id),\n    onMutate: async (id: string) => {\n      await queryClient.cancelQueries({ queryKey: [\"diaries\", userId] });\n      const previous = queryClient.getQueriesData<Diary[]>({\n        queryKey: [\"diaries\", userId],\n      });\n\n      updateCachedLists((item) => (item.id === id ? null : item));\n\n      return { previous };\n    },\n    onError: (_err, _vars, context) => {\n      context?.previous?.forEach(([key, value]) =>\n        queryClient.setQueryData(key, value)\n      );\n    },\n    onSuccess: () => {\n      invalidateLists();\n    },\n  });\n\n  return { create, update, remove };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 502, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/domain/archive.ts"],"sourcesContent":["export type ArchiveType = \"grammar\" | \"word\";\n\nexport interface LearningArchive {\n  id: string;\n  userId: string;\n  type: ArchiveType;\n  title: string;\n  examples: string[];\n  rootMeaning: string;\n  sourceId?: string;\n  createdAt: Date;\n}\n\nexport interface LearningArchiveDraft {\n  userId: string;\n  type: ArchiveType;\n  title: string;\n  examples?: string[];\n  rootMeaning?: string;\n  sourceId?: string;\n}\n\nexport interface QuizQuestion {\n  id: string;\n  archiveId: string;\n  question: string;\n  options: string[];\n  answer: number;\n  explanation: string;\n}\n\nexport function buildQuizFromArchive(entry: LearningArchive): QuizQuestion {\n  const correct = entry.rootMeaning || entry.title;\n  const distractors = entry.examples.slice(0, 3).map((ex, idx) => `${ex} (ex ${idx + 1})`);\n  const options = [correct, ...distractors].slice(0, 4);\n  return {\n    id: `${entry.id}-quiz`,\n    archiveId: entry.id,\n    question: `What is the key meaning/pattern for \"${entry.title}\"?`,\n    options,\n    answer: 0,\n    explanation: entry.rootMeaning || entry.title,\n  };\n}\n"],"names":[],"mappings":";;;;AA+BO,SAAS,qBAAqB,KAAsB;IACzD,MAAM,UAAU,MAAM,WAAW,IAAI,MAAM,KAAK;IAChD,MAAM,cAAc,MAAM,QAAQ,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,IAAI,MAAQ,GAAG,GAAG,KAAK,EAAE,MAAM,EAAE,CAAC,CAAC;IACvF,MAAM,UAAU;QAAC;WAAY;KAAY,CAAC,KAAK,CAAC,GAAG;IACnD,OAAO;QACL,IAAI,GAAG,MAAM,EAAE,CAAC,KAAK,CAAC;QACtB,WAAW,MAAM,EAAE;QACnB,UAAU,CAAC,qCAAqC,EAAE,MAAM,KAAK,CAAC,EAAE,CAAC;QACjE;QACA,QAAQ;QACR,aAAa,MAAM,WAAW,IAAI,MAAM,KAAK;IAC/C;AACF"}},
    {"offset": {"line": 526, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/infrastructure/firebase/archive-repository.ts"],"sourcesContent":["import {\n  LearningArchive,\n  LearningArchiveDraft,\n} from \"@/domain/archive\";\nimport { db } from \"@/lib/firebase\";\nimport {\n  addDoc,\n  collection,\n  getDocs,\n  orderBy,\n  query,\n  serverTimestamp,\n  Timestamp,\n  where,\n  QueryDocumentSnapshot,\n  DocumentData,\n} from \"firebase/firestore\";\n\nconst archiveCol = collection(db, \"learning_archive\");\n\nfunction mapArchive(doc: QueryDocumentSnapshot<DocumentData>): LearningArchive {\n  const data = doc.data();\n  const createdAt =\n    data.createdAt instanceof Timestamp\n      ? data.createdAt.toDate()\n      : new Date(data.createdAt ?? Date.now());\n  return {\n    id: doc.id,\n    userId: data.userId,\n    type: data.type,\n    title: data.title,\n    examples: data.examples || [],\n    rootMeaning: data.rootMeaning || \"\",\n    sourceId: data.sourceId,\n    createdAt,\n  };\n}\n\nexport async function listArchive(userId: string, type?: string, sourceId?: string) {\n  console.log(\"üîç Archive Repository: listArchive called\", { userId, type, sourceId });\n  \n  if (!userId) {\n    console.log(\"‚ö†Ô∏è Archive Repository: No userId, returning empty array\");\n    return [];\n  }\n\n  try {\n    const filters = [where(\"userId\", \"==\", userId)];\n    if (type) filters.push(where(\"type\", \"==\", type));\n    if (sourceId) filters.push(where(\"sourceId\", \"==\", sourceId));\n\n    // orderByÎ•º ÏûÑÏãúÎ°ú Ï†úÍ±∞ÌïòÏó¨ Ïù∏Îç±Ïä§ Î¨∏Ï†úÏù∏ÏßÄ ÌôïÏù∏\n    const q = query(archiveCol, ...filters);\n    \n    // Î≥µÌï© ÏøºÎ¶¨Ïùò Í≤ΩÏö∞ Firestore Ïù∏Îç±Ïä§Í∞Ä ÌïÑÏöîÌï† Ïàò ÏûàÏùå\n    if (sourceId) {\n      // sourceIdÎ°ú ÌïÑÌÑ∞ÎßÅÌï† ÎïåÎäî orderBy createdAtÏù¥ Ïù∏Îç±Ïä§Î•º ÏöîÍµ¨Ìï† Í∞ÄÎä•ÏÑ±Ïù¥ ÎÜíÏùå\n      // ÏóêÎü¨ Î∞©ÏßÄÎ•º ÏúÑÌï¥ orderBy(\"createdAt\", \"desc\")Î•º Ìï®Íªò ÏøºÎ¶¨Ïóê Ï∂îÍ∞ÄÌïòÍ≥† Ïã∂ÏßÄÎßå\n      // ÌòÑÏû¨ ÏΩîÎìúÎäî ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ï†ïÎ†¨ÏùÑ ÏÇ¨Ïö© Ï§ëÏù¥ÎØÄÎ°ú Ïù¥ÎåÄÎ°ú Ïú†ÏßÄ\n    }\n\n    console.log(\"üîç Archive Repository: Executing query...\");\n    const snapshot = await getDocs(q);\n    const results = snapshot.docs.map(mapArchive);\n    \n    // ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ÏÇ¨Ïù¥ÎìúÏóêÏÑú Ï†ïÎ†¨\n    results.sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\n    \n    console.log(\"‚úÖ Archive Repository: Query complete\", { count: results.length, results: results.slice(0, 2) });\n    return results;\n  } catch (error) {\n    console.error(\"‚ùå Archive Repository: Query failed\", error);\n    throw error;\n  }\n}\n\nexport async function checkDuplicate(userId: string, title: string): Promise<boolean> {\n  console.log(\"üîç Archive Repository: checkDuplicate\", { userId, title });\n  \n  if (!userId || !title) {\n    return false;\n  }\n\n  try {\n    const q = query(\n      archiveCol,\n      where(\"userId\", \"==\", userId),\n      where(\"title\", \"==\", title)\n    );\n    \n    const snapshot = await getDocs(q);\n    const exists = !snapshot.empty;\n    \n    console.log(exists ? \"‚ö†Ô∏è Archive Repository: Duplicate found\" : \"‚úÖ Archive Repository: No duplicate\");\n    return exists;\n  } catch (error) {\n    console.error(\"‚ùå Archive Repository: Check duplicate failed\", error);\n    return false;\n  }\n}\n\nexport async function createArchive(input: LearningArchiveDraft): Promise<LearningArchive> {\n  const payload = {\n    ...input,\n    createdAt: serverTimestamp(),\n  };\n  const ref = await addDoc(archiveCol, payload);\n  const saved = await getDocs(query(archiveCol, where(\"__name__\", \"==\", ref.id)));\n  return saved.docs.map(mapArchive)[0];\n}\n"],"names":[],"mappings":";;;;;;;;AAIA;AACA;AAAA;;;AAaA,MAAM,aAAa,IAAA,0MAAU,EAAC,uJAAE,EAAE;AAElC,SAAS,WAAW,GAAwC;IAC1D,MAAM,OAAO,IAAI,IAAI;IACrB,MAAM,YACJ,KAAK,SAAS,YAAY,yMAAS,GAC/B,KAAK,SAAS,CAAC,MAAM,KACrB,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,GAAG;IACzC,OAAO;QACL,IAAI,IAAI,EAAE;QACV,QAAQ,KAAK,MAAM;QACnB,MAAM,KAAK,IAAI;QACf,OAAO,KAAK,KAAK;QACjB,UAAU,KAAK,QAAQ,IAAI,EAAE;QAC7B,aAAa,KAAK,WAAW,IAAI;QACjC,UAAU,KAAK,QAAQ;QACvB;IACF;AACF;AAEO,eAAe,YAAY,MAAc,EAAE,IAAa,EAAE,QAAiB;IAChF,QAAQ,GAAG,CAAC,6CAA6C;QAAE;QAAQ;QAAM;IAAS;IAElF,IAAI,CAAC,QAAQ;QACX,QAAQ,GAAG,CAAC;QACZ,OAAO,EAAE;IACX;IAEA,IAAI;QACF,MAAM,UAAU;YAAC,IAAA,qMAAK,EAAC,UAAU,MAAM;SAAQ;QAC/C,IAAI,MAAM,QAAQ,IAAI,CAAC,IAAA,qMAAK,EAAC,QAAQ,MAAM;QAC3C,IAAI,UAAU,QAAQ,IAAI,CAAC,IAAA,qMAAK,EAAC,YAAY,MAAM;QAEnD,gCAAgC;QAChC,MAAM,IAAI,IAAA,qMAAK,EAAC,eAAe;QAE/B,oCAAoC;QACpC,IAAI,UAAU;QACZ,wDAAwD;QACxD,0DAA0D;QAC1D,kCAAkC;QACpC;QAEA,QAAQ,GAAG,CAAC;QACZ,MAAM,WAAW,MAAM,IAAA,uMAAO,EAAC;QAC/B,MAAM,UAAU,SAAS,IAAI,CAAC,GAAG,CAAC;QAElC,iBAAiB;QACjB,QAAQ,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,SAAS,CAAC,OAAO,KAAK,EAAE,SAAS,CAAC,OAAO;QAElE,QAAQ,GAAG,CAAC,wCAAwC;YAAE,OAAO,QAAQ,MAAM;YAAE,SAAS,QAAQ,KAAK,CAAC,GAAG;QAAG;QAC1G,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sCAAsC;QACpD,MAAM;IACR;AACF;AAEO,eAAe,eAAe,MAAc,EAAE,KAAa;IAChE,QAAQ,GAAG,CAAC,yCAAyC;QAAE;QAAQ;IAAM;IAErE,IAAI,CAAC,UAAU,CAAC,OAAO;QACrB,OAAO;IACT;IAEA,IAAI;QACF,MAAM,IAAI,IAAA,qMAAK,EACb,YACA,IAAA,qMAAK,EAAC,UAAU,MAAM,SACtB,IAAA,qMAAK,EAAC,SAAS,MAAM;QAGvB,MAAM,WAAW,MAAM,IAAA,uMAAO,EAAC;QAC/B,MAAM,SAAS,CAAC,SAAS,KAAK;QAE9B,QAAQ,GAAG,CAAC,SAAS,2CAA2C;QAChE,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gDAAgD;QAC9D,OAAO;IACT;AACF;AAEO,eAAe,cAAc,KAA2B;IAC7D,MAAM,UAAU;QACd,GAAG,KAAK;QACR,WAAW,IAAA,+MAAe;IAC5B;IACA,MAAM,MAAM,MAAM,IAAA,sMAAM,EAAC,YAAY;IACrC,MAAM,QAAQ,MAAM,IAAA,uMAAO,EAAC,IAAA,qMAAK,EAAC,YAAY,IAAA,qMAAK,EAAC,YAAY,MAAM,IAAI,EAAE;IAC5E,OAAO,MAAM,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE;AACtC"}},
    {"offset": {"line": 625, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/application/archive/archive-service.ts"],"sourcesContent":["import {\n  buildQuizFromArchive,\n  LearningArchive,\n  LearningArchiveDraft,\n  QuizQuestion,\n} from \"@/domain/archive\";\nimport { createArchive, listArchive } from \"@/infrastructure/firebase/archive-repository\";\n\nexport async function saveArchiveEntry(input: LearningArchiveDraft) {\n  if (!input.title.trim()) {\n    throw new Error(\"title-required\");\n  }\n  return createArchive({\n    ...input,\n    examples: input.examples?.filter(Boolean) ?? [],\n    rootMeaning: input.rootMeaning ?? \"\",\n  });\n}\n\nexport async function getArchives(userId: string, type?: string, sourceId?: string): Promise<LearningArchive[]> {\n  return listArchive(userId, type, sourceId);\n}\n\nexport function generateQuiz(entry: LearningArchive): QuizQuestion {\n  return buildQuizFromArchive(entry);\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AAMA;;;AAEO,eAAe,iBAAiB,KAA2B;IAChE,IAAI,CAAC,MAAM,KAAK,CAAC,IAAI,IAAI;QACvB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO,IAAA,sMAAa,EAAC;QACnB,GAAG,KAAK;QACR,UAAU,MAAM,QAAQ,EAAE,OAAO,YAAY,EAAE;QAC/C,aAAa,MAAM,WAAW,IAAI;IACpC;AACF;AAEO,eAAe,YAAY,MAAc,EAAE,IAAa,EAAE,QAAiB;IAChF,OAAO,IAAA,oMAAW,EAAC,QAAQ,MAAM;AACnC;AAEO,SAAS,aAAa,KAAsB;IACjD,OAAO,IAAA,2KAAoB,EAAC;AAC9B"}},
    {"offset": {"line": 657, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/domain/quiz.ts"],"sourcesContent":["export interface Quiz {\n  id: string;\n  archiveId: string;\n  question: string;\n  options: string[];\n  correctIndex: number;\n  explanation: string;\n  createdAt: Date;\n}\n\nexport interface QuizDraft {\n  archiveId: string;\n  question: string;\n  options: string[];\n  correctIndex: number;\n  explanation: string;\n}\n\n/**\n * Randomize quiz options and return with new correct index\n */\nexport function randomizeQuizOptions(quiz: Quiz): Quiz {\n  const shuffled = quiz.options\n    .map((option, index) => ({ option, index }))\n    .sort(() => Math.random() - 0.5);\n  \n  const newCorrectIndex = shuffled.findIndex(\n    item => item.index === quiz.correctIndex\n  );\n  \n  return {\n    ...quiz,\n    options: shuffled.map(item => item.option),\n    correctIndex: newCorrectIndex,\n  };\n}\n"],"names":[],"mappings":";;;;AAqBO,SAAS,qBAAqB,IAAU;IAC7C,MAAM,WAAW,KAAK,OAAO,CAC1B,GAAG,CAAC,CAAC,QAAQ,QAAU,CAAC;YAAE;YAAQ;QAAM,CAAC,GACzC,IAAI,CAAC,IAAM,KAAK,MAAM,KAAK;IAE9B,MAAM,kBAAkB,SAAS,SAAS,CACxC,CAAA,OAAQ,KAAK,KAAK,KAAK,KAAK,YAAY;IAG1C,OAAO;QACL,GAAG,IAAI;QACP,SAAS,SAAS,GAAG,CAAC,CAAA,OAAQ,KAAK,MAAM;QACzC,cAAc;IAChB;AACF"}},
    {"offset": {"line": 677, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/infrastructure/firebase/quiz-repository.ts"],"sourcesContent":["import { Quiz, QuizDraft } from \"@/domain/quiz\";\nimport { db } from \"@/lib/firebase\";\nimport {\n  addDoc,\n  collection,\n  getDocs,\n  query,\n  where,\n  serverTimestamp,\n  Timestamp,\n  QueryDocumentSnapshot,\n  DocumentData,\n} from \"firebase/firestore\";\n\nconst quizzesCollection = collection(db, \"quizzes\");\n\nfunction mapQuiz(snapshot: QueryDocumentSnapshot<DocumentData>): Quiz {\n  const data = snapshot.data();\n  const createdAt =\n    data.createdAt instanceof Timestamp\n      ? data.createdAt.toDate()\n      : new Date(data.createdAt ?? Date.now());\n\n  return {\n    id: snapshot.id,\n    archiveId: data.archiveId,\n    question: data.question,\n    options: data.options || [],\n    correctIndex: data.correctIndex ?? 0,\n    explanation: data.explanation || \"\",\n    createdAt,\n  };\n}\n\nexport async function getQuizByArchiveId(\n  archiveId: string\n): Promise<Quiz | null> {\n  console.log(\"üîç Quiz Repository: getQuizByArchiveId called\", { archiveId });\n  \n  if (!archiveId) {\n    console.log(\"‚ö†Ô∏è Quiz Repository: No archiveId provided\");\n    return null;\n  }\n\n  try {\n    const q = query(quizzesCollection, where(\"archiveId\", \"==\", archiveId));\n    const snapshot = await getDocs(q);\n\n    if (snapshot.empty) {\n      console.log(\"üì≠ Quiz Repository: No quiz found for archiveId\", archiveId);\n      return null;\n    }\n\n    const quiz = mapQuiz(snapshot.docs[0]);\n    console.log(\"‚úÖ Quiz Repository: Quiz found\", { quizId: quiz.id });\n    return quiz;\n  } catch (error) {\n    console.error(\"‚ùå Quiz Repository: Query failed\", error);\n    return null;\n  }\n}\n\nexport async function createQuiz(draft: QuizDraft): Promise<Quiz> {\n  console.log(\"üíæ Quiz Repository: Creating quiz\", { archiveId: draft.archiveId });\n  \n  const payload = {\n    ...draft,\n    createdAt: serverTimestamp(),\n  };\n\n  const docRef = await addDoc(quizzesCollection, payload);\n  const snapshot = await getDocs(\n    query(quizzesCollection, where(\"__name__\", \"==\", docRef.id))\n  );\n\n  const quiz = mapQuiz(snapshot.docs[0]);\n  console.log(\"‚úÖ Quiz Repository: Quiz created\", { quizId: quiz.id });\n  return quiz;\n}\n"],"names":[],"mappings":";;;;;;AACA;AACA;AAAA;;;AAYA,MAAM,oBAAoB,IAAA,0MAAU,EAAC,uJAAE,EAAE;AAEzC,SAAS,QAAQ,QAA6C;IAC5D,MAAM,OAAO,SAAS,IAAI;IAC1B,MAAM,YACJ,KAAK,SAAS,YAAY,yMAAS,GAC/B,KAAK,SAAS,CAAC,MAAM,KACrB,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,GAAG;IAEzC,OAAO;QACL,IAAI,SAAS,EAAE;QACf,WAAW,KAAK,SAAS;QACzB,UAAU,KAAK,QAAQ;QACvB,SAAS,KAAK,OAAO,IAAI,EAAE;QAC3B,cAAc,KAAK,YAAY,IAAI;QACnC,aAAa,KAAK,WAAW,IAAI;QACjC;IACF;AACF;AAEO,eAAe,mBACpB,SAAiB;IAEjB,QAAQ,GAAG,CAAC,iDAAiD;QAAE;IAAU;IAEzE,IAAI,CAAC,WAAW;QACd,QAAQ,GAAG,CAAC;QACZ,OAAO;IACT;IAEA,IAAI;QACF,MAAM,IAAI,IAAA,qMAAK,EAAC,mBAAmB,IAAA,qMAAK,EAAC,aAAa,MAAM;QAC5D,MAAM,WAAW,MAAM,IAAA,uMAAO,EAAC;QAE/B,IAAI,SAAS,KAAK,EAAE;YAClB,QAAQ,GAAG,CAAC,mDAAmD;YAC/D,OAAO;QACT;QAEA,MAAM,OAAO,QAAQ,SAAS,IAAI,CAAC,EAAE;QACrC,QAAQ,GAAG,CAAC,iCAAiC;YAAE,QAAQ,KAAK,EAAE;QAAC;QAC/D,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO;IACT;AACF;AAEO,eAAe,WAAW,KAAgB;IAC/C,QAAQ,GAAG,CAAC,qCAAqC;QAAE,WAAW,MAAM,SAAS;IAAC;IAE9E,MAAM,UAAU;QACd,GAAG,KAAK;QACR,WAAW,IAAA,+MAAe;IAC5B;IAEA,MAAM,SAAS,MAAM,IAAA,sMAAM,EAAC,mBAAmB;IAC/C,MAAM,WAAW,MAAM,IAAA,uMAAO,EAC5B,IAAA,qMAAK,EAAC,mBAAmB,IAAA,qMAAK,EAAC,YAAY,MAAM,OAAO,EAAE;IAG5D,MAAM,OAAO,QAAQ,SAAS,IAAI,CAAC,EAAE;IACrC,QAAQ,GAAG,CAAC,mCAAmC;QAAE,QAAQ,KAAK,EAAE;IAAC;IACjE,OAAO;AACT"}},
    {"offset": {"line": 747, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/application/quiz/quiz-service.ts"],"sourcesContent":["import { Quiz, QuizDraft, randomizeQuizOptions } from \"@/domain/quiz\";\nimport { getQuizByArchiveId, createQuiz } from \"@/infrastructure/firebase/quiz-repository\";\n\ninterface GenerateQuizRequest {\n  title: string;\n  rootMeaning: string;\n  examples: string[];\n  uiLocale: string;\n  learningLanguage: string;\n}\n\nasync function generateQuizWithGrok(\n  request: GenerateQuizRequest\n): Promise<{ options: string[]; correctIndex: number; explanation: string } | null> {\n  try {\n    const response = await fetch(\"/api/quiz/generate\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(request),\n    });\n\n    if (!response.ok) {\n      console.error(\"Quiz generation API failed:\", response.status);\n      return null;\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error(\"Quiz generation request failed:\", error);\n    return null;\n  }\n}\n\nexport async function getOrGenerateQuiz(\n  archiveId: string,\n  title: string,\n  rootMeaning: string,\n  examples: string[],\n  question: string,\n  uiLocale: string,\n  learningLanguage: string\n): Promise<Quiz | null> {\n  console.log(\"üéØ Quiz Service: getOrGenerateQuiz\", { archiveId, title });\n\n  // 1. Check if quiz exists in Firebase\n  const existingQuiz = await getQuizByArchiveId(archiveId);\n  if (existingQuiz) {\n    console.log(\"‚úÖ Quiz Service: Found existing quiz\", { quizId: existingQuiz.id });\n    return randomizeQuizOptions(existingQuiz);\n  }\n\n  console.log(\"ü§ñ Quiz Service: No quiz found, generating with Grok AI...\");\n\n  // 2. Generate quiz with Grok AI\n  const generated = await generateQuizWithGrok({\n    title,\n    rootMeaning,\n    examples,\n    uiLocale,\n    learningLanguage,\n  });\n\n  if (!generated) {\n    console.error(\"‚ùå Quiz Service: Quiz generation failed\");\n    return null;\n  }\n\n  // 3. Save to Firebase\n  const draft: QuizDraft = {\n    archiveId,\n    question,\n    options: generated.options,\n    correctIndex: generated.correctIndex,\n    explanation: generated.explanation,\n  };\n\n  const savedQuiz = await createQuiz(draft);\n  console.log(\"üíæ Quiz Service: Quiz saved to Firebase\", { quizId: savedQuiz.id });\n\n  return randomizeQuizOptions(savedQuiz);\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAUA,eAAe,qBACb,OAA4B;IAE5B,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,sBAAsB;YACjD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;QACvB;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,QAAQ,KAAK,CAAC,+BAA+B,SAAS,MAAM;YAC5D,OAAO;QACT;QAEA,OAAO,MAAM,SAAS,IAAI;IAC5B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO;IACT;AACF;AAEO,eAAe,kBACpB,SAAiB,EACjB,KAAa,EACb,WAAmB,EACnB,QAAkB,EAClB,QAAgB,EAChB,QAAgB,EAChB,gBAAwB;IAExB,QAAQ,GAAG,CAAC,sCAAsC;QAAE;QAAW;IAAM;IAErE,sCAAsC;IACtC,MAAM,eAAe,MAAM,IAAA,wMAAkB,EAAC;IAC9C,IAAI,cAAc;QAChB,QAAQ,GAAG,CAAC,uCAAuC;YAAE,QAAQ,aAAa,EAAE;QAAC;QAC7E,OAAO,IAAA,wKAAoB,EAAC;IAC9B;IAEA,QAAQ,GAAG,CAAC;IAEZ,gCAAgC;IAChC,MAAM,YAAY,MAAM,qBAAqB;QAC3C;QACA;QACA;QACA;QACA;IACF;IAEA,IAAI,CAAC,WAAW;QACd,QAAQ,KAAK,CAAC;QACd,OAAO;IACT;IAEA,sBAAsB;IACtB,MAAM,QAAmB;QACvB;QACA;QACA,SAAS,UAAU,OAAO;QAC1B,cAAc,UAAU,YAAY;QACpC,aAAa,UAAU,WAAW;IACpC;IAEA,MAAM,YAAY,MAAM,IAAA,gMAAU,EAAC;IACnC,QAAQ,GAAG,CAAC,2CAA2C;QAAE,QAAQ,UAAU,EAAE;IAAC;IAE9E,OAAO,IAAA,wKAAoB,EAAC;AAC9B"}},
    {"offset": {"line": 818, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/application/archive/hooks.ts"],"sourcesContent":["\"use client\";\n\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { getArchives, saveArchiveEntry } from \"./archive-service\";\nimport { LearningArchive, buildQuizFromArchive } from \"@/domain/archive\";\nimport { Quiz } from \"@/domain/quiz\";\nimport { getOrGenerateQuiz } from \"@/application/quiz/quiz-service\";\nimport { useLocale } from \"next-intl\";\nimport { useState, useEffect } from \"react\";\n\nexport function useArchiveList(userId: string, type?: string, opts?: { enabled?: boolean; sourceId?: string }) {\n  return useQuery<LearningArchive[]>({\n    queryKey: [\"archives\", userId, type ?? \"all\", opts?.sourceId ?? \"all\"],\n    queryFn: () => getArchives(userId, type, opts?.sourceId),\n    enabled: (opts?.enabled ?? true) && Boolean(userId),\n    staleTime: 60_000,\n    refetchOnMount: true,\n  });\n}\n\nexport function useArchiveMutations(userId: string) {\n  const client = useQueryClient();\n  const create = useMutation({\n    mutationFn: saveArchiveEntry,\n    onSuccess: () => client.invalidateQueries({ queryKey: [\"archives\", userId] }),\n  });\n  return { create };\n}\n\nexport function useQuiz(\n  entry?: LearningArchive,\n  translatedQuestion?: string,\n  uiLocale?: string,\n  learningLanguage?: string\n) {\n  const [quiz, setQuiz] = useState<Quiz | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!entry || !translatedQuestion) {\n      setQuiz(null);\n      setIsLoading(false);\n      return;\n    }\n\n    let cancelled = false;\n\n    async function loadQuiz() {\n      if (!entry || !translatedQuestion) return;\n\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const result = await getOrGenerateQuiz(\n          entry.id,\n          entry.title,\n          entry.rootMeaning || entry.title,\n          entry.examples || [],\n          translatedQuestion,\n          uiLocale || \"en\",\n          learningLanguage || \"en\"\n        );\n\n        if (!cancelled) {\n          setQuiz(result);\n          if (!result) {\n            setError(\"Quiz generation failed\");\n          }\n        }\n      } catch (err) {\n        if (!cancelled) {\n          console.error(\"Quiz loading error:\", err);\n          setError(\"Failed to load quiz\");\n          setQuiz(null);\n        }\n      } finally {\n        if (!cancelled) {\n          setIsLoading(false);\n        }\n      }\n    }\n\n    loadQuiz();\n\n    return () => {\n      cancelled = true;\n    };\n  }, [entry?.id, translatedQuestion, uiLocale, learningLanguage]);\n\n  return { quiz, isLoading, error };\n}\n"],"names":[],"mappings":";;;;;;;;AAEA;AAAA;AAAA;AACA;AAGA;AAEA;AARA;;;;;AAUO,SAAS,eAAe,MAAc,EAAE,IAAa,EAAE,IAA+C;IAC3G,OAAO,IAAA,kNAAQ,EAAoB;QACjC,UAAU;YAAC;YAAY;YAAQ,QAAQ;YAAO,MAAM,YAAY;SAAM;QACtE,SAAS,IAAM,IAAA,6LAAW,EAAC,QAAQ,MAAM,MAAM;QAC/C,SAAS,CAAC,MAAM,WAAW,IAAI,KAAK,QAAQ;QAC5C,WAAW;QACX,gBAAgB;IAClB;AACF;AAEO,SAAS,oBAAoB,MAAc;IAChD,MAAM,SAAS,IAAA,mOAAc;IAC7B,MAAM,SAAS,IAAA,wNAAW,EAAC;QACzB,YAAY,kMAAgB;QAC5B,WAAW,IAAM,OAAO,iBAAiB,CAAC;gBAAE,UAAU;oBAAC;oBAAY;iBAAO;YAAC;IAC7E;IACA,OAAO;QAAE;IAAO;AAClB;AAEO,SAAS,QACd,KAAuB,EACvB,kBAA2B,EAC3B,QAAiB,EACjB,gBAAyB;IAEzB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,4OAAQ,EAAc;IAC9C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,4OAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,4OAAQ,EAAgB;IAElD,IAAA,6OAAS,EAAC;QACR,IAAI,CAAC,SAAS,CAAC,oBAAoB;YACjC,QAAQ;YACR,aAAa;YACb;QACF;QAEA,IAAI,YAAY;QAEhB,eAAe;YACb,IAAI,CAAC,SAAS,CAAC,oBAAoB;YAEnC,aAAa;YACb,SAAS;YAET,IAAI;gBACF,MAAM,SAAS,MAAM,IAAA,6LAAiB,EACpC,MAAM,EAAE,EACR,MAAM,KAAK,EACX,MAAM,WAAW,IAAI,MAAM,KAAK,EAChC,MAAM,QAAQ,IAAI,EAAE,EACpB,oBACA,YAAY,MACZ,oBAAoB;gBAGtB,IAAI,CAAC,WAAW;oBACd,QAAQ;oBACR,IAAI,CAAC,QAAQ;wBACX,SAAS;oBACX;gBACF;YACF,EAAE,OAAO,KAAK;gBACZ,IAAI,CAAC,WAAW;oBACd,QAAQ,KAAK,CAAC,uBAAuB;oBACrC,SAAS;oBACT,QAAQ;gBACV;YACF,SAAU;gBACR,IAAI,CAAC,WAAW;oBACd,aAAa;gBACf;YACF;QACF;QAEA;QAEA,OAAO;YACL,YAAY;QACd;IACF,GAAG;QAAC,OAAO;QAAI;QAAoB;QAAU;KAAiB;IAE9D,OAAO;QAAE;QAAM;QAAW;IAAM;AAClC"}},
    {"offset": {"line": 921, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/lib/current-user.ts"],"sourcesContent":["import { auth } from \"@/lib/firebase\";\n\n// Returns Firebase UID if logged in, otherwise a local fallback for demo.\nexport function getCurrentUserId() {\n  if (typeof window !== \"undefined\" && auth.currentUser?.uid) {\n    return auth.currentUser.uid;\n  }\n  return \"demo-user\";\n}\n"],"names":[],"mappings":";;;;AAAA;;AAGO,SAAS;IACd,IAAI,kDAAkB,eAAe,yJAAI,CAAC,WAAW,EAAE;;IAGvD,OAAO;AACT"}},
    {"offset": {"line": 936, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,iMAAO,EAAC,IAAA,wKAAI,EAAC;AACtB"}},
    {"offset": {"line": 951, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/components/ui/Card.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"glass-card bg-white/5 text-card-foreground p-6\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\";\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 pb-4\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\";\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight text-lg\", className)}\n    {...props}\n  />\n));\nCardTitle.displayName = \"CardTitle\";\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"pt-0\", className)} {...props} />\n));\nCardContent.displayName = \"CardContent\";\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center pt-4\", className)}\n    {...props}\n  />\n));\nCardFooter.displayName = \"CardFooter\";\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardContent };\n"],"names":[],"mappings":";;;;;;;;;;;;;AAAA;AACA;;;;AAEA,MAAM,qBAAO,8OAAgB,CAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yQAAC;QACC,KAAK;QACL,WAAW,IAAA,oJAAE,EACX,kDACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,8OAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yQAAC;QACC,KAAK;QACL,WAAW,IAAA,oJAAE,EAAC,kCAAkC;QAC/C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,8OAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yQAAC;QACC,KAAK;QACL,WAAW,IAAA,oJAAE,EAAC,qDAAqD;QAClE,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,8OAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yQAAC;QAAI,KAAK;QAAK,WAAW,IAAA,oJAAE,EAAC,QAAQ;QAAa,GAAG,KAAK;;;;;;AAE5D,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,8OAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,yQAAC;QACC,KAAK;QACL,WAAW,IAAA,oJAAE,EAAC,0BAA0B;QACvC,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 1024, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/components/ui/Button.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { Loader2 } from \"lucide-react\";\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: \"primary\" | \"secondary\" | \"ghost\" | \"glass\" | \"destructive\";\n  size?: \"sm\" | \"md\" | \"lg\" | \"icon\";\n  isLoading?: boolean;\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant = \"primary\", size = \"md\", isLoading, children, ...props }, ref) => {\n    const variants = {\n      primary: \"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md\",\n      secondary: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n      ghost: \"hover:bg-white/10 text-foreground\",\n      glass: \"glass hover:bg-white/10 text-foreground active:scale-95 transition-transform\",\n      destructive: \"bg-red-500 text-white hover:bg-red-600\",\n    };\n\n    const sizes = {\n      sm: \"h-8 px-3 text-xs\",\n      md: \"h-10 px-4 py-2\",\n      lg: \"h-12 px-8 text-lg\",\n      icon: \"h-10 w-10 p-2 flex items-center justify-center\",\n    };\n\n    return (\n      <button\n        className={cn(\n          \"inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary disabled:pointer-events-none disabled:opacity-50\",\n          variants[variant],\n          sizes[size],\n          className\n        )}\n        ref={ref}\n        disabled={isLoading || props.disabled}\n        {...props}\n      >\n        {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n        {children}\n      </button>\n    );\n  }\n);\nButton.displayName = \"Button\";\n\nexport { Button };\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AASA,MAAM,uBAAS,8OAAgB,CAC7B,CAAC,EAAE,SAAS,EAAE,UAAU,SAAS,EAAE,OAAO,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IAC/E,MAAM,WAAW;QACf,SAAS;QACT,WAAW;QACX,OAAO;QACP,OAAO;QACP,aAAa;IACf;IAEA,MAAM,QAAQ;QACZ,IAAI;QACJ,IAAI;QACJ,IAAI;QACJ,MAAM;IACR;IAEA,qBACE,yQAAC;QACC,WAAW,IAAA,oJAAE,EACX,gNACA,QAAQ,CAAC,QAAQ,EACjB,KAAK,CAAC,KAAK,EACX;QAEF,KAAK;QACL,UAAU,aAAa,MAAM,QAAQ;QACpC,GAAG,KAAK;;YAER,2BAAa,yQAAC,uPAAO;gBAAC,WAAU;;;;;;YAChC;;;;;;;AAGP;AAEF,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 1077, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/components/auth/AuthGate.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, type ReactNode } from \"react\";\nimport { useAuth } from \"@/application/auth/AuthProvider\";\nimport { Button } from \"@/components/ui/Button\";\nimport { Card, CardContent, CardFooter, CardHeader, CardTitle } from \"@/components/ui/Card\";\nimport { routing } from \"@/i18n/routing\";\nimport { useLocale, useTranslations } from \"next-intl\";\nimport { Languages, Loader2, NotebookPen, ShieldCheck, Sparkles } from \"lucide-react\";\n\ntype AuthGateProps = {\n  children: ReactNode;\n};\n\nexport function AuthGate({ children }: AuthGateProps) {\n  const { user, loading, signInWithGoogle } = useAuth();\n  const t = useTranslations(\"auth\");\n  const locale = useLocale();\n\n  const languageList = useMemo(() => {\n    try {\n      const displayNames = new Intl.DisplayNames([locale], { type: \"language\" });\n      return routing.locales\n        .map((code) => displayNames.of(code) || code)\n        .join(\" ¬∑ \");\n    } catch (_error) {\n      return routing.locales.join(\" ¬∑ \");\n    }\n  }, [locale]);\n\n  if (loading) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center gap-3\">\n        <Loader2 className=\"h-6 w-6 animate-spin text-primary\" aria-hidden />\n        <p className=\"text-sm text-muted-foreground\">{t(\"loading\")}</p>\n      </div>\n    );\n  }\n\n  if (!user) {\n    const steps = [\n      { icon: NotebookPen, text: t(\"steps.write\") },\n      { icon: Sparkles, text: t(\"steps.review\") },\n      { icon: ShieldCheck, text: t(\"steps.save\") },\n    ];\n\n    return (\n      <div className=\"flex min-h-screen items-center justify-center px-4 py-10\">\n        <Card className=\"w-full max-w-4xl border-white/10 bg-gradient-to-b from-white/5 to-white/0\">\n          <CardHeader className=\"space-y-3 text-center\">\n            <CardTitle className=\"text-3xl font-bold text-foreground\">{t(\"title\")}</CardTitle>\n            <p className=\"text-sm text-muted-foreground\">{t(\"description\")}</p>\n            <p className=\"text-sm font-medium text-primary\">{t(\"requirement\")}</p>\n            <p className=\"text-xs text-muted-foreground\">{t(\"after_login\")}</p>\n          </CardHeader>\n\n          <CardContent className=\"grid gap-4 md:grid-cols-3\">\n            {steps.map((step) => {\n              const Icon = step.icon;\n              return (\n                <div\n                  key={step.text}\n                  className=\"flex items-start gap-3 rounded-xl border border-white/10 bg-white/5 p-4\"\n                >\n                  <Icon className=\"h-5 w-5 text-primary\" aria-hidden />\n                  <p className=\"text-sm leading-relaxed text-foreground\">{step.text}</p>\n                </div>\n              );\n            })}\n            <div className=\"md:col-span-3\">\n              <div className=\"flex items-start gap-3 rounded-xl border border-white/10 bg-white/5 p-4\">\n                <Languages className=\"h-5 w-5 text-primary\" aria-hidden />\n                <div>\n                  <p className=\"text-sm font-medium text-foreground\">{t(\"languages_label\")}</p>\n                  <p className=\"text-sm text-muted-foreground\">{languageList}</p>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n\n          <CardFooter className=\"flex flex-col items-center gap-3\">\n            <Button\n              size=\"lg\"\n              className=\"w-full bg-primary text-primary-foreground hover:bg-primary/90 border border-primary/60 shadow-lg shadow-primary/30 md:w-auto\"\n              onClick={() => signInWithGoogle()}\n            >\n              {t(\"cta\")}\n            </Button>\n          </CardFooter>\n        </Card>\n      </div>\n    );\n  }\n\n  return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AARA;;;;;;;;;AAcO,SAAS,SAAS,EAAE,QAAQ,EAAiB;IAClD,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,gBAAgB,EAAE,GAAG,IAAA,iLAAO;IACnD,MAAM,IAAI,IAAA,oOAAe,EAAC;IAC1B,MAAM,SAAS,IAAA,0MAAS;IAExB,MAAM,eAAe,IAAA,2OAAO,EAAC;QAC3B,IAAI;YACF,MAAM,eAAe,IAAI,KAAK,YAAY,CAAC;gBAAC;aAAO,EAAE;gBAAE,MAAM;YAAW;YACxE,OAAO,4JAAO,CAAC,OAAO,CACnB,GAAG,CAAC,CAAC,OAAS,aAAa,EAAE,CAAC,SAAS,MACvC,IAAI,CAAC;QACV,EAAE,OAAO,QAAQ;YACf,OAAO,4JAAO,CAAC,OAAO,CAAC,IAAI,CAAC;QAC9B;IACF,GAAG;QAAC;KAAO;IAEX,IAAI,SAAS;QACX,qBACE,yQAAC;YAAI,WAAU;;8BACb,yQAAC,uPAAO;oBAAC,WAAU;oBAAoC,aAAW;;;;;;8BAClE,yQAAC;oBAAE,WAAU;8BAAiC,EAAE;;;;;;;;;;;;IAGtD;IAEA,IAAI,CAAC,MAAM;QACT,MAAM,QAAQ;YACZ;gBAAE,MAAM,8PAAW;gBAAE,MAAM,EAAE;YAAe;YAC5C;gBAAE,MAAM,iPAAQ;gBAAE,MAAM,EAAE;YAAgB;YAC1C;gBAAE,MAAM,8PAAW;gBAAE,MAAM,EAAE;YAAc;SAC5C;QAED,qBACE,yQAAC;YAAI,WAAU;sBACb,cAAA,yQAAC,mKAAI;gBAAC,WAAU;;kCACd,yQAAC,yKAAU;wBAAC,WAAU;;0CACpB,yQAAC,wKAAS;gCAAC,WAAU;0CAAsC,EAAE;;;;;;0CAC7D,yQAAC;gCAAE,WAAU;0CAAiC,EAAE;;;;;;0CAChD,yQAAC;gCAAE,WAAU;0CAAoC,EAAE;;;;;;0CACnD,yQAAC;gCAAE,WAAU;0CAAiC,EAAE;;;;;;;;;;;;kCAGlD,yQAAC,0KAAW;wBAAC,WAAU;;4BACpB,MAAM,GAAG,CAAC,CAAC;gCACV,MAAM,OAAO,KAAK,IAAI;gCACtB,qBACE,yQAAC;oCAEC,WAAU;;sDAEV,yQAAC;4CAAK,WAAU;4CAAuB,aAAW;;;;;;sDAClD,yQAAC;4CAAE,WAAU;sDAA2C,KAAK,IAAI;;;;;;;mCAJ5D,KAAK,IAAI;;;;;4BAOpB;0CACA,yQAAC;gCAAI,WAAU;0CACb,cAAA,yQAAC;oCAAI,WAAU;;sDACb,yQAAC,oPAAS;4CAAC,WAAU;4CAAuB,aAAW;;;;;;sDACvD,yQAAC;;8DACC,yQAAC;oDAAE,WAAU;8DAAuC,EAAE;;;;;;8DACtD,yQAAC;oDAAE,WAAU;8DAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAMtD,yQAAC,yKAAU;wBAAC,WAAU;kCACpB,cAAA,yQAAC,uKAAM;4BACL,MAAK;4BACL,WAAU;4BACV,SAAS,IAAM;sCAEd,EAAE;;;;;;;;;;;;;;;;;;;;;;IAMf;IAEA,qBAAO;kBAAG;;AACZ"}},
    {"offset": {"line": 1331, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/lib/intl-format.ts"],"sourcesContent":["export function formatDate(value: string | Date, locale: string) {\n  const date = typeof value === \"string\" ? new Date(`${value}T00:00:00`) : value;\n  return new Intl.DateTimeFormat(locale, { year: \"numeric\", month: \"short\", day: \"numeric\" }).format(date);\n}\n\nexport function formatNumber(value: number, locale: string) {\n  return new Intl.NumberFormat(locale).format(value);\n}\n"],"names":[],"mappings":";;;;;;AAAO,SAAS,WAAW,KAAoB,EAAE,MAAc;IAC7D,MAAM,OAAO,OAAO,UAAU,WAAW,IAAI,KAAK,GAAG,MAAM,SAAS,CAAC,IAAI;IACzE,OAAO,IAAI,KAAK,cAAc,CAAC,QAAQ;QAAE,MAAM;QAAW,OAAO;QAAS,KAAK;IAAU,GAAG,MAAM,CAAC;AACrG;AAEO,SAAS,aAAa,KAAa,EAAE,MAAc;IACxD,OAAO,IAAI,KAAK,YAAY,CAAC,QAAQ,MAAM,CAAC;AAC9C"}},
    {"offset": {"line": 1352, "column": 0}, "map": {"version":3,"sources":["file:///Users/maccrey/Development/Loglingo/src/app/%5Blocale%5D/diary/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { use } from \"react\";\nimport { useDiaryDetail } from \"@/application/diary/hooks\";\nimport { useArchiveList } from \"@/application/archive/hooks\";\nimport { getCurrentUserId } from \"@/lib/current-user\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/Card\";\nimport { useTranslations } from \"next-intl\";\nimport { AuthGate } from \"@/components/auth/AuthGate\";\nimport { useRouter } from \"@/i18n/routing\";\nimport { Archive, Sparkles, Edit3, ArrowLeft } from \"lucide-react\";\nimport { Button } from \"@/components/ui/Button\";\nimport NextImage from \"next/image\";\nimport { formatDate } from \"@/lib/intl-format\";\nimport { useLocale } from \"next-intl\";\n\nexport default function DiaryViewPage({ params }: { params: Promise<{ id: string }> }) {\n  const { id } = use(params);\n  const userId = getCurrentUserId();\n  const t = useTranslations(\"diary\");\n  const tArchive = useTranslations(\"archive\");\n  const locale = useLocale();\n  const router = useRouter();\n  const { data, isLoading } = useDiaryDetail(userId, id);\n  const { data: archives = [], isLoading: archivesLoading } = useArchiveList(userId, undefined, { sourceId: id });\n\n  if (isLoading) {\n    return (\n      <AuthGate>\n        <Card className=\"max-w-3xl mx-auto\">\n          <CardHeader>\n            <CardTitle>{t(\"loading\")}</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"h-32 animate-pulse rounded-lg bg-white/5\" />\n          </CardContent>\n        </Card>\n      </AuthGate>\n    );\n  }\n\n  if (!data) {\n    return (\n      <AuthGate>\n        <Card className=\"max-w-3xl mx-auto\">\n          <CardHeader>\n            <CardTitle>{t(\"not_found\")}</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground\">{t(\"not_found_desc\")}</p>\n          </CardContent>\n        </Card>\n      </AuthGate>\n    );\n  }\n\n  return (\n    <AuthGate>\n      <div className=\"mx-auto max-w-3xl space-y-6\">\n        {/* ÏùºÍ∏∞ ÎÇ¥Ïö© */}\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => router.push(\"/diary\")}\n              >\n                <ArrowLeft className=\"mr-2 h-4 w-4\" />\n                {t(\"back\")}\n              </Button>\n              <Button \n                variant=\"secondary\" \n                size=\"sm\"\n                onClick={() => router.push(`/diary/${id}/edit`)}\n              >\n                <Edit3 className=\"mr-2 h-4 w-4\" />\n                {t(\"edit\")}\n              </Button>\n            </div>\n            <CardTitle className=\"text-2xl mt-4\">\n              {formatDate(new Date(`${data.date}T00:00:00`), locale)}\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {data.imageUrl && (\n              <NextImage\n                src={data.imageUrl}\n                alt=\"Diary image\"\n                width={1200}\n                height={800}\n                className=\"w-full rounded-lg object-cover\"\n                loading=\"lazy\"\n              />\n            )}\n            <p className=\"whitespace-pre-wrap text-foreground leading-relaxed\">\n              {data.content}\n            </p>\n          </CardContent>\n        </Card>\n\n        {/* Í¥ÄÎ†® ÏïÑÏπ¥Ïù¥Î∏å Ìï≠Î™© ÌëúÏãú */}\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center gap-2\">\n              <Archive className=\"h-5 w-5 text-primary\" />\n              <CardTitle>{tArchive(\"title\")}</CardTitle>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {archivesLoading ? (\n              <div className=\"h-20 animate-pulse rounded-lg bg-white/5\" />\n            ) : archives.length > 0 ? (\n              <div className=\"space-y-2\">\n                <p className=\"text-sm text-muted-foreground mb-3\">\n                  Ïù¥ ÏùºÍ∏∞ÏóêÏÑú Ï†ÄÏû•Îêú ÌïôÏäµ Ìï≠Î™©Îì§\n                </p>\n                <div className=\"max-h-60 overflow-y-auto space-y-2 pr-1 custom-scrollbar\">\n                  {archives.map((archive) => (\n                    <div\n                      key={archive.id}\n                      className=\"rounded-lg border border-white/10 bg-white/5 p-3 hover:bg-white/10 transition-colors cursor-pointer\"\n                      onClick={() => router.push(\"/archive\")}\n                    >\n                      <div className=\"flex items-start justify-between gap-2\">\n                        <div className=\"flex-1\">\n                          <p className=\"text-sm font-medium text-foreground\">\n                            {archive.title}\n                          </p>\n                          {archive.rootMeaning && (\n                            <p className=\"text-xs text-muted-foreground mt-1\">\n                              {archive.rootMeaning}\n                            </p>\n                          )}\n                        </div>\n                        <span className=\"text-xs px-2 py-1 rounded-full bg-primary/10 text-primary\">\n                          {archive.type === \"grammar\" ? \"Î¨∏Î≤ï\" : \"Îã®Ïñ¥\"}\n                        </span>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            ) : (\n              <div className=\"text-center py-6\">\n                <Sparkles className=\"h-8 w-8 text-muted-foreground mx-auto mb-2\" />\n                <p className=\"text-sm text-muted-foreground\">\n                  ÏïÑÏßÅ Ï†ÄÏû•Îêú ÌïôÏäµ Ìï≠Î™©Ïù¥ ÏóÜÏäµÎãàÎã§\n                </p>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  AI ÍµêÏ†ïÏùÑ ÏÇ¨Ïö©ÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú Ï†ÄÏû•Îê©ÎãàÎã§\n                </p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </AuthGate>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}